---
title: Créer un compte de stockage Azure et un coffre de clés
description: Cette rubrique explique comment créer un compte de stockage Azure et un coffre de clés.
author: gionoder
manager: AnnBe
ms.date: 09/22/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 97423
ms.assetid: ''
ms.search.region: Global
ms.author: janeaug
ms.search.validFrom: 2020-07-08
ms.dyn365.ops.version: AX 10.0.12
ms.openlocfilehash: b8e39539f767cc2944a9a7fdda09121921c64763
ms.sourcegitcommit: 025561f6a21fe8705493daa290f3f6bfb9f1b962
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/23/2020
ms.locfileid: "3835956"
---
# <a name="create-an-azure-storage-account-and-a-key-vault"></a><span data-ttu-id="bb173-103">Créer un compte de stockage Azure et un coffre de clés</span><span class="sxs-lookup"><span data-stu-id="bb173-103">Create an Azure storage account and a key vault</span></span>

[!include [banner](../includes/banner.md)]
[!include [banner](../includes/preview-banner.md)]


<span data-ttu-id="bb173-104">Le service complémentaire de facturation électronique prend la responsabilité de stocker toutes vos données métier dans les ressources Microsoft Azure appartenant à votre société.</span><span class="sxs-lookup"><span data-stu-id="bb173-104">The Electronic invoicing add-on service takes responsibility for storing all your business data in the Microsoft Azure resources that are owned by your company.</span></span> <span data-ttu-id="bb173-105">Pour vous assurer que le service fonctionne correctement et que toutes les données métier nécessaires et générées par le module complémentaire de facturation électronique ne sont accessibles que par ce dernier, vous devez créer deux ressources Azure principales :</span><span class="sxs-lookup"><span data-stu-id="bb173-105">To ensure that the service works correctly, and that all the business data that is needed for and generated by the Electronic invoicing add-on is accessed only by the add-on, you must create two main Azure resources:</span></span>

- <span data-ttu-id="bb173-106">Un compte de stockage Azure (stockage Blob) pour stocker les factures électroniques</span><span class="sxs-lookup"><span data-stu-id="bb173-106">An Azure storage account (Blob storage) to store electronic invoices</span></span>
- <span data-ttu-id="bb173-107">Un coffre de clés Azure pour stocker les certificats et l'Uniform Resource Identifier (URI) du compte de stockage</span><span class="sxs-lookup"><span data-stu-id="bb173-107">An Azure key vault to store certificates and the Uniform Resource Identifier (URI) of the storage account</span></span>

> [!NOTE]
> <span data-ttu-id="bb173-108">Une ressource de coffre de clés dédiée et un stockage Blob client doivent être alloués spécifiquement pour une utilisation avec le module complémentaire de facturation électronique.</span><span class="sxs-lookup"><span data-stu-id="bb173-108">A dedicated key vault resource and customer Blob storage must be allocated specifically for use with the Electronic invoicing add-on.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="bb173-109">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="bb173-109">Prerequisites</span></span>

<span data-ttu-id="bb173-110">Avant de pouvoir effectuer les étapes de cette rubrique, vous devez vérifier que les tâches suivantes ont été réalisées :</span><span class="sxs-lookup"><span data-stu-id="bb173-110">Before you can complete the steps in this topic, you must make sure that the following tasks have been completed:</span></span>

- <span data-ttu-id="bb173-111">Créer une ressource de coffre de clés dans Azure.</span><span class="sxs-lookup"><span data-stu-id="bb173-111">Create a key vault resource in Azure.</span></span> <span data-ttu-id="bb173-112">Pour plus d'informations, voir [À propos de Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview).</span><span class="sxs-lookup"><span data-stu-id="bb173-112">For more information, see [About Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview).</span></span>
- <span data-ttu-id="bb173-113">Créer un compte de stockage Azure (stockage Blob).</span><span class="sxs-lookup"><span data-stu-id="bb173-113">Create an Azure storage account (Blob storage).</span></span> <span data-ttu-id="bb173-114">Pour plus d'informations, voir [Gestion du compte de stockage Azure](https://docs.microsoft.com/azure/storage/blobs/).</span><span class="sxs-lookup"><span data-stu-id="bb173-114">For more information, see [Maintaining Azure Storage Account](https://docs.microsoft.com/azure/storage/blobs/).</span></span>

## <a name="overview"></a><span data-ttu-id="bb173-115">Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="bb173-115">Overview</span></span>

<span data-ttu-id="bb173-116">Dans cette rubrique, vous effectuerez deux étapes principales :</span><span class="sxs-lookup"><span data-stu-id="bb173-116">In this topic, you will complete two main steps:</span></span>

- <span data-ttu-id="bb173-117">Configurer le compte de stockage Azure pour obtenir l'URI du compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="bb173-117">Set up the Azure storage account to get the storage account URI.</span></span>
- <span data-ttu-id="bb173-118">Configurer le coffre de clés pour stocker l'URI du compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="bb173-118">Set up the key vault to store the storage account URI.</span></span>

## <a name="set-up-the-azure-storage-account-to-get-the-storage-account-uri"></a><span data-ttu-id="bb173-119">Configurer le compte de stockage Azure pour obtenir l'URI du compte de stockage</span><span class="sxs-lookup"><span data-stu-id="bb173-119">Set up the Azure storage account to get the storage account URI</span></span>

1. <span data-ttu-id="bb173-120">Ouvrez le compte de stockage que vous prévoyez d'utiliser avec le module complémentaire de facturation électronique.</span><span class="sxs-lookup"><span data-stu-id="bb173-120">Open the storage account that you plan to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="bb173-121">Allez dans **Service Blob** \> **Conteneurs** et créez un nouveau conteneur.</span><span class="sxs-lookup"><span data-stu-id="bb173-121">Go to **Blob service** \> **Containers**, and create a new container.</span></span>
3. <span data-ttu-id="bb173-122">Entrez un nom pour le conteneur et définissez le champ **Niveau d'accès public** sur **Privé (pas d'accès anonyme)**.</span><span class="sxs-lookup"><span data-stu-id="bb173-122">Enter a name for the container, and set the **Public access level** field to **Private (no anonymous access)**.</span></span>
4. <span data-ttu-id="bb173-123">Ouvrez le conteneur et accédez à **Paramètres \> Stratégie d'accès**.</span><span class="sxs-lookup"><span data-stu-id="bb173-123">Open the container, and go to **Settings \> Access policy**.</span></span>
5. <span data-ttu-id="bb173-124">Sélectionnez **Ajouter une stratégie** pour ajouter une stratégie d'accès stockée.</span><span class="sxs-lookup"><span data-stu-id="bb173-124">Select **Add policy** to add a stored access policy.</span></span>
6. <span data-ttu-id="bb173-125">Définissez les champs **Identifiant** et **Autorisations** au besoin.</span><span class="sxs-lookup"><span data-stu-id="bb173-125">Set the **Identifier** and **Permissions** fields as appropriate.</span></span> <span data-ttu-id="bb173-126">Dans le champ **Autorisations**, vous devez sélectionner toutes les autorisations.</span><span class="sxs-lookup"><span data-stu-id="bb173-126">In the **Permissions** field, you should select all permissions.</span></span>

    ![Octroi de l'autorisation de stockage Blob](media/e-Invoicing-services-create-azure-resources-grant-blob-permissions.png)

7. <span data-ttu-id="bb173-128">Entrez les dates de début et d'expiration.</span><span class="sxs-lookup"><span data-stu-id="bb173-128">Enter the start and expiry dates.</span></span> <span data-ttu-id="bb173-129">La date d'expiration doit être dans le futur.</span><span class="sxs-lookup"><span data-stu-id="bb173-129">The expiry date should be in future.</span></span>
8. <span data-ttu-id="bb173-130">Cliquez sur **OK** pour enregistrer la stratégie, puis enregistrez vos modifications du conteneur.</span><span class="sxs-lookup"><span data-stu-id="bb173-130">Select **OK** to save the policy, and then save your changes to the container.</span></span>
9. <span data-ttu-id="bb173-131">Revenez au compte de stockage et ouvrez l'**Explorateur de stockage (version préliminaire)**.</span><span class="sxs-lookup"><span data-stu-id="bb173-131">Return to the storage account, and open **Storage Explorer (preview)**.</span></span>
10. <span data-ttu-id="bb173-132">Cliquez avec le bouton droit sur le conteneur, puis sélectionnez **Obtenir la signature d'accès partagé**.</span><span class="sxs-lookup"><span data-stu-id="bb173-132">Right-click the container, and then select **Get Shared Access Signature**.</span></span>
11. <span data-ttu-id="bb173-133">Dans la boîte de dialogue **Signature d'accès partagé**, copiez et stockez la valeur dans le champ **URI**.</span><span class="sxs-lookup"><span data-stu-id="bb173-133">In the **Shared Access Signature** dialog box, copy and store the value in the **URI** field.</span></span> <span data-ttu-id="bb173-134">Cette valeur sera utilisée dans la procédure suivante et sera appelée *URI de la signature d'accès partagé*.</span><span class="sxs-lookup"><span data-stu-id="bb173-134">This value will be used in the next procedure and will be referred to as the *shared access signature URI*.</span></span>

    ![Sélection et copie de la valeur de l'URI](media/e-Invoicing-services-create-azure-resources-select-and-copy-uri.png)

## <a name="set-up-the-key-vault-to-store-the-storage-account-uri"></a><span data-ttu-id="bb173-136">Configurer le coffre de clés pour stocker l'URI du compte de stockage</span><span class="sxs-lookup"><span data-stu-id="bb173-136">Set up the key vault to store the storage account URI</span></span>

1. <span data-ttu-id="bb173-137">Ouvrez le coffre de clés que vous souhaitez utiliser avec le module complémentaire de facturation électronique.</span><span class="sxs-lookup"><span data-stu-id="bb173-137">Open the key vault that you intend to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="bb173-138">Allez dans **Paramètres** \> **Secrets**, puis sélectionnez **Générer/Importer** pour créer un nouveau secret.</span><span class="sxs-lookup"><span data-stu-id="bb173-138">Go to **Settings** \> **Secrets**, and then select **Generate/Import** to create a new secret.</span></span>
3. <span data-ttu-id="bb173-139">Sur la page **Créer un secret**, dans le champ **Options de téléchargement**, sélectionnez **Manuel**.</span><span class="sxs-lookup"><span data-stu-id="bb173-139">On the **Create a secret** page, in the **Upload options** field, select **Manual**.</span></span>
4. <span data-ttu-id="bb173-140">Entrez le nom du secret.</span><span class="sxs-lookup"><span data-stu-id="bb173-140">Enter the name of the secret.</span></span> <span data-ttu-id="bb173-141">Ce nom sera utilisé lors de la configuration du service dans Regulatory Configuration Service (RCS) et sera appelé *nom du secret du coffre de clés*.</span><span class="sxs-lookup"><span data-stu-id="bb173-141">This name will be used during setup of the service in Regulatory Configuration Service (RCS) and will be referred to as the *key vault secret name*.</span></span>
5. <span data-ttu-id="bb173-142">Dans le champ **Valeur**, sélectionnez **URI de la signature d'accès partagé**, puis sélectionnez **Créer**.</span><span class="sxs-lookup"><span data-stu-id="bb173-142">In the **Value** field, select **Shared Access Signature URI**, and then select **Create**.</span></span>
6. <span data-ttu-id="bb173-143">Configurez la stratégie d'accès pour accorder au module complémentaire de facturation électronique le niveau correct d'accès sécurisé au secret que vous avez créé.</span><span class="sxs-lookup"><span data-stu-id="bb173-143">Set up the access policy to grant the Electronic invoicing add-on the correct level of secure access to the secret you created.</span></span> <span data-ttu-id="bb173-144">Allez dans **Paramètres \> Stratégie d'accès** et sélectionnez **Ajouter une stratégie d'accès**.</span><span class="sxs-lookup"><span data-stu-id="bb173-144">Go to **Settings \> Access policy**, and select **Add Access Policy**.</span></span>
7. <span data-ttu-id="bb173-145">Définissez les autorisations du secret pour les opérations **Obtenir** et **Lister**.</span><span class="sxs-lookup"><span data-stu-id="bb173-145">Set the secret permissions for the **Get** and **List** operations.</span></span>

    ![Autorisation de l'accès au service](media/e-Invoicing-services-create-azure-resources-grant-service-access.png)

8. <span data-ttu-id="bb173-147">Définissez les autorisations du certificat pour les opérations **Obtenir** et **Lister**.</span><span class="sxs-lookup"><span data-stu-id="bb173-147">Set the certificate permissions for **Get** and **List** operations.</span></span>

    ![Octroi de l'autorisation de certificat](media/e-Invoicing-services-create-azure-resources-grant-certificate-permission.png)

9. <span data-ttu-id="bb173-149">Dans la boîte de dialogue **Principal**, sélectionnez le principal en ajoutant **Module complémentaire de facturation électronique**.</span><span class="sxs-lookup"><span data-stu-id="bb173-149">In the **Principal** dialog box, select the principal by adding **Electronic invoicing add-on**.</span></span>
10. <span data-ttu-id="bb173-150">Sélectionnez **Ajouter**, puis sélectionnez **Enregistrer les modifications du coffre de clés**.</span><span class="sxs-lookup"><span data-stu-id="bb173-150">Select **Add**, and then select **Save Key Vault changes**.</span></span>
11. <span data-ttu-id="bb173-151">Sur la page **Vue d'ensemble**, copiez la valeur **Nom DNS** du coffre de clés.</span><span class="sxs-lookup"><span data-stu-id="bb173-151">On the **Overview** page, copy the **DNS name** value for the key vault.</span></span> <span data-ttu-id="bb173-152">Cette valeur sera utilisée lors de la configuration du service dans RCS et sera désignée sous le nom *URI du coffre de clés*.</span><span class="sxs-lookup"><span data-stu-id="bb173-152">This value will be used during setup of the service in RCS and will be referred as the *key vault URI*.</span></span>
