---
title: "Configurer l'importation des données à partir de SharePoint"
description: "Cette rubrique décrit la procédure d'importation des données à partir de Microsoft SharePoint."
author: NickSelin
manager: AnnBe
ms.date: 05/21/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.translationtype: HT
ms.sourcegitcommit: 821d8927211d7ac3e479848c7e7bef9f650d4340
ms.openlocfilehash: 9f23f73e9a98fc50c622255bf6ed027c41ec8010
ms.contentlocale: fr-fr
ms.lasthandoff: 08/13/2018

---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="73f78-103">Configurer l'importation des données à partir de SharePoint</span><span class="sxs-lookup"><span data-stu-id="73f78-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="73f78-104">Pour importer des données à partir d'un fichier entrant à l'aide de la structure de gestion des états électroniques, vous devez configurer un format ER prenant en charge l'importation et exécuter une mise en correspondance de modèles du type **Vers la destination** qui utilise ce format comme source de données.</span><span class="sxs-lookup"><span data-stu-id="73f78-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="73f78-105">Pour importer des données, vous devez accéder au fichier à importer.</span><span class="sxs-lookup"><span data-stu-id="73f78-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="73f78-106">Le fichier entrant peut être sélectionné manuellement par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="73f78-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="73f78-107">Avec la nouvelle fonctionnalité ER de prise en charge de l'importation des données à partir de Microsoft SharePoint, ce processus peut être configuré en mode sans assistance.</span><span class="sxs-lookup"><span data-stu-id="73f78-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as the unattended one.</span></span> <span data-ttu-id="73f78-108">Vous pouvez utiliser les configurations ER pour procéder à l'importation des données à partir des fichiers stockés dans les dossiers Microsoft SharePoint.</span><span class="sxs-lookup"><span data-stu-id="73f78-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="73f78-109">Cette rubrique explique comment effectuer l'importation de SharePoint vers Microsoft Dynamics 365 for Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="73f78-109">This topic explains how to complete the import from SharePoint to Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="73f78-110">Les exemples utilisent les transactions fournisseur comme données commerciales.</span><span class="sxs-lookup"><span data-stu-id="73f78-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="73f78-111">Logiciels requis</span><span class="sxs-lookup"><span data-stu-id="73f78-111">Prerequisites</span></span>
<span data-ttu-id="73f78-112">Pour exécuter les exemples décrits dans cette rubrique, vous devez disposer de l'accès suivant :</span><span class="sxs-lookup"><span data-stu-id="73f78-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="73f78-113">L'accès à Finance and Operations pour l'un des rôles suivants :</span><span class="sxs-lookup"><span data-stu-id="73f78-113">Access to Finance and Operations for one of the following roles:</span></span>

    - <span data-ttu-id="73f78-114">Développeur de gestion des états électroniques</span><span class="sxs-lookup"><span data-stu-id="73f78-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="73f78-115">Consultant fonctionnel de gestion des états électroniques</span><span class="sxs-lookup"><span data-stu-id="73f78-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="73f78-116">Administrateur système</span><span class="sxs-lookup"><span data-stu-id="73f78-116">System administrator</span></span>

- <span data-ttu-id="73f78-117">L'accès à l'instance de Microsoft SharePoint Server qui est configurée pour être utilisée avec Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="73f78-117">Access to the instance of Microsoft SharePoint Server that is configured for use with Finance and Operations</span></span>
- <span data-ttu-id="73f78-118">Configurations du format et du modèle ER pour les paiements de déclaration des honoraires</span><span class="sxs-lookup"><span data-stu-id="73f78-118">ER format and model configurations for 1099 payments</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="73f78-119">Créer les configurations ER requises</span><span class="sxs-lookup"><span data-stu-id="73f78-119">Create required ER configurations</span></span>
<span data-ttu-id="73f78-120">Lisez les guides de tâches **ER Importer des données à partir d'un fichier Microsoft Excel**, qui font partie du processus d'entreprise **7.5.4.3 Acquérir/Développer des composants de services/solutions informatiques (10677)**.</span><span class="sxs-lookup"><span data-stu-id="73f78-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="73f78-121">Ces guides de tâches vous aident tout au long du processus de création et d'utilisation des configurations ER pour importer en mode interactif des transactions fournisseur à partir de fichiers Microsoft Excel externes.</span><span class="sxs-lookup"><span data-stu-id="73f78-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from external Microsoft Excel files.</span></span> <span data-ttu-id="73f78-122">Pour plus d'informations, voir [Analyser les documents entrants dans Microsoft Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="73f78-122">For more information, see [Parse incoming documents in Microsoft Excel](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="73f78-123">Enfin, vous aurez :</span><span class="sxs-lookup"><span data-stu-id="73f78-123">Fianlly, you will have:</span></span>

- <span data-ttu-id="73f78-124">Configurations ER :</span><span class="sxs-lookup"><span data-stu-id="73f78-124">ER configurations:</span></span>

    - <span data-ttu-id="73f78-125">Configuration du modèle ER, **Modèle de paiements de déclaration des honoraires**</span><span class="sxs-lookup"><span data-stu-id="73f78-125">ER model configuration, **1099 Payments model**</span></span>
    - <span data-ttu-id="73f78-126">Configuration du format ER, **Format d'importation des transactions des fournisseurs à partir d'Excel**</span><span class="sxs-lookup"><span data-stu-id="73f78-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

    <span data-ttu-id="73f78-127">[![Configurations ER pour l'importation des données à partir de SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-127">[![ER configurations for importing data from SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span></span>

- <span data-ttu-id="73f78-128">Exemple de fichier entrant pour l'importation des données :</span><span class="sxs-lookup"><span data-stu-id="73f78-128">Sample of the incoming file for data import:</span></span>

    - <span data-ttu-id="73f78-129">Fichier Excel **1099import-data.xlsx**, avec les transactions fournisseur qui doivent être importées dans Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="73f78-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported into Finance and Operations</span></span>

    <span data-ttu-id="73f78-130">[![Exemple de fichier Microsoft Excel pour l'importation à partir de SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-130">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span></span>

> [!NOTE]
> <span data-ttu-id="73f78-131">Le format d'importation des transactions fournisseur est sélectionné comme mise en correspondance des modèles par défaut.</span><span class="sxs-lookup"><span data-stu-id="73f78-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="73f78-132">Par conséquent, si vous exécutez une mise en correspondance du **Modèle de paiements de déclaration des honoraires** et si cette mise en correspondance du modèle est de type **Vers la destination**, la mise en correspondance des modèles exécute ce format pour importer les données à partir de fichiers externes.</span><span class="sxs-lookup"><span data-stu-id="73f78-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="73f78-133">Elle utilise ensuite ces données pour mettre à jour les tables d'application.</span><span class="sxs-lookup"><span data-stu-id="73f78-133">It then uses that data to update application tables.</span></span>

## <a name="configure-document-management-parameters"></a><span data-ttu-id="73f78-134">Configurer les paramètres de gestion des documents</span><span class="sxs-lookup"><span data-stu-id="73f78-134">Configure Document management parameters</span></span>
1. <span data-ttu-id="73f78-135">Dans la page **Paramètres de gestion des documents**, configurez l'accès à l'instance de SharePoint Server qui sera utilisée par la société à laquelle vous êtes actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="73f78-135">On the **Document management parameters** page, configure access to the SharePoint Server instance that will be used by the company that you're currently signed in to.</span></span> <span data-ttu-id="73f78-136">Dans cet exemple, la société est USMF.</span><span class="sxs-lookup"><span data-stu-id="73f78-136">In this example, the company is USMF.</span></span>
2. <span data-ttu-id="73f78-137">Testez la connexion à l'instance de SharePoint Server pour vous assurer que vous en avez obtenu l'accès.</span><span class="sxs-lookup"><span data-stu-id="73f78-137">Test the connection to the SharePoint Server instance to make sure that you've been granted access.</span></span>

    <span data-ttu-id="73f78-138">[![Paramètre de gestion des documents – Serveur SharePoint](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span><span class="sxs-lookup"><span data-stu-id="73f78-138">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span></span>

3. <span data-ttu-id="73f78-139">Ouvrez le site SharePoint configuré, puis créez les dossiers suivants dans lesquels les fichiers entrants peuvent être enregistrés :</span><span class="sxs-lookup"><span data-stu-id="73f78-139">Open the configured SharePoint site, and create the following folders where the incoming files can be stored:</span></span>

    - <span data-ttu-id="73f78-140">Source d'importation de fichiers (principale)</span><span class="sxs-lookup"><span data-stu-id="73f78-140">Files import source (main)</span></span>
    - <span data-ttu-id="73f78-141">Source d'importation de fichiers (secondaire)</span><span class="sxs-lookup"><span data-stu-id="73f78-141">Files import source (alternative)</span></span>

    <span data-ttu-id="73f78-142">[![Paramètre de gestion des documents – Serveur SharePoint](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span><span class="sxs-lookup"><span data-stu-id="73f78-142">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span></span>

    <span data-ttu-id="73f78-143">[![Paramètre de gestion des documents – Serveur SharePoint](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span><span class="sxs-lookup"><span data-stu-id="73f78-143">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span></span>

4. <span data-ttu-id="73f78-144">Dans Finance and Operations, dans la page **Types de document**, créez les types de documents suivants qui seront utilisés pour accéder aux dossiers SharePoint que vous venez de créer :</span><span class="sxs-lookup"><span data-stu-id="73f78-144">In Finance and Operations, on the **Document types** page, create the following document types that will be used to access the SharePoint folders that you just created:</span></span>

    - <span data-ttu-id="73f78-145">SP principal</span><span class="sxs-lookup"><span data-stu-id="73f78-145">SP Main</span></span>
    - <span data-ttu-id="73f78-146">SP secondaire</span><span class="sxs-lookup"><span data-stu-id="73f78-146">SP Alternative</span></span>

5. <span data-ttu-id="73f78-147">Pour les types de documents créés, dans le champ **Groupe**, entrez **Fichier** et dans le champ **Emplacement**, entrez **SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="73f78-147">For created document types, in the **Group** field, enter **File** and in the **Location** field, enter **SharePoint**.</span></span> <span data-ttu-id="73f78-148">Entrez ensuite l'adresse du dossier SharePoint :</span><span class="sxs-lookup"><span data-stu-id="73f78-148">Then enter the address of the SharePoint folder:</span></span>

    - <span data-ttu-id="73f78-149">Pour le type de document **SP principal** : Source d'importation de fichiers (principale)</span><span class="sxs-lookup"><span data-stu-id="73f78-149">For the **SP Main** document type: Files import source (main)</span></span>
    - <span data-ttu-id="73f78-150">Pour le type de document **SP secondaire** : Source d'importation de fichiers (secondaire)</span><span class="sxs-lookup"><span data-stu-id="73f78-150">For the **SP Alternative** document type: Files import source (alternative)</span></span>

    <span data-ttu-id="73f78-151">[![Paramètre SharePoint – Nouveau type de document](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span><span class="sxs-lookup"><span data-stu-id="73f78-151">[![SharePoint setting – new document type](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span></span>

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="73f78-152">Configurer les sources ER pour le format ER</span><span class="sxs-lookup"><span data-stu-id="73f78-152">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="73f78-153">Cliquez sur **Administration d'organisation** \> **Gestion des états électroniques** \> **Source de la gestion des états électroniques**.</span><span class="sxs-lookup"><span data-stu-id="73f78-153">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="73f78-154">Dans la page **Source de la gestion des états électroniques**, configurez les fichiers source pour l'importation des données à l'aide du format ER configuré.</span><span class="sxs-lookup"><span data-stu-id="73f78-154">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="73f78-155">Définissez un masque de nom de fichier, afin que seuls les fichiers portant l'extension .xlsx soient importés.</span><span class="sxs-lookup"><span data-stu-id="73f78-155">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="73f78-156">Le masque de nom de fichier est facultatif et est utilisé uniquement s'il a été défini.</span><span class="sxs-lookup"><span data-stu-id="73f78-156">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="73f78-157">Vous ne pouvez définir qu'un seul masque pour chaque format ER.</span><span class="sxs-lookup"><span data-stu-id="73f78-157">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="73f78-158">Sélectionnez les deux dossiers SharePoint que vous avez créés précédemment.</span><span class="sxs-lookup"><span data-stu-id="73f78-158">Select both SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="73f78-159">[![Paramètre de source de fichiers ER](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-159">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="73f78-160">La *source* ER est définie individuellement pour chaque société d'application.</span><span class="sxs-lookup"><span data-stu-id="73f78-160">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="73f78-161">En revanche, les *configurations* ER sont partagées entre les sociétés.</span><span class="sxs-lookup"><span data-stu-id="73f78-161">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="73f78-162">Lorsque vous supprimez un paramètre de source ER pour un format ER, tous les états de fichier connectés (voir ci-dessous) sont également supprimés.</span><span class="sxs-lookup"><span data-stu-id="73f78-162">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="73f78-163">Examiner les états de fichier pour le format ER</span><span class="sxs-lookup"><span data-stu-id="73f78-163">Review the files states for the ER format</span></span>
1. <span data-ttu-id="73f78-164">Dans la page **Source de la gestion des états électroniques**, sélectionnez **États de fichier pour les sources** pour examiner le contenu des sources de fichier configurées pour le format ER actuel.</span><span class="sxs-lookup"><span data-stu-id="73f78-164">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="73f78-165">Dans la section **Fichiers**, examinez la liste des fichiers.</span><span class="sxs-lookup"><span data-stu-id="73f78-165">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="73f78-166">Cette liste affiche les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="73f78-166">This list presents the following:</span></span>

    - <span data-ttu-id="73f78-167">Fichiers source applicables, selon le masque de nom de fichier (si un masque de nom de fichier est défini), et prêts pour l'importation des données.</span><span class="sxs-lookup"><span data-stu-id="73f78-167">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="73f78-168">Pour ces fichiers, la section **Journaux source pour le format d'importation** est vide.</span><span class="sxs-lookup"><span data-stu-id="73f78-168">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="73f78-169">Fichiers précédemment importés.</span><span class="sxs-lookup"><span data-stu-id="73f78-169">Previously imported files.</span></span> <span data-ttu-id="73f78-170">Pour chacun de ces fichiers, dans la section **Journaux source pour le format d'importation**, vous pouvez examiner l'historique d'importation de ce fichier.</span><span class="sxs-lookup"><span data-stu-id="73f78-170">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="73f78-171">Vous pouvez également ouvrir la page **États de fichier pour les sources** en sélectionnant **Administration d'organisation** \> **Gestion des états électroniques** \> **États de fichier pour les sources**.</span><span class="sxs-lookup"><span data-stu-id="73f78-171">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="73f78-172">Dans ce cas, la page fournit des informations sur les sources de fichier pour tous les formats ER pour lesquels les sources de fichier ont été configurées dans la société à laquelle vous êtes actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="73f78-172">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="73f78-173">Importer des données à partir de fichiers Excel contenus dans un dossier SharePoint</span><span class="sxs-lookup"><span data-stu-id="73f78-173">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="73f78-174">Dans SharePoint, transférez le fichier Microsoft Excel **1099import-data.xlsx** contenant les transactions fournisseur vers le dossier SharePoint **Source d'importation de fichiers (principale)** que vous avez créé précédemment.</span><span class="sxs-lookup"><span data-stu-id="73f78-174">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="73f78-175">[![Contenu SharePoint – Fichier Microsoft Excel pour l'importation](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="73f78-175">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="73f78-176">Dans Finance and Operations, dans la page **États de fichier pour les sources**, sélectionnez **Actualiser** pour actualiser la page.</span><span class="sxs-lookup"><span data-stu-id="73f78-176">In Finance and Operations, on the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="73f78-177">Notez que le fichier Excel qui a été transféré vers SharePoint est affiché dans cet écran avec le statut **Prêt**.</span><span class="sxs-lookup"><span data-stu-id="73f78-177">Note that the Excel file that was uploaded to SharePoint appeared in this form with the status **Ready**.</span></span> <span data-ttu-id="73f78-178">Les statuts suivants sont actuellement pris en charge :</span><span class="sxs-lookup"><span data-stu-id="73f78-178">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="73f78-179">**Prêt** – Affecté automatiquement pour chaque nouveau fichier dans un dossier SharePoint.</span><span class="sxs-lookup"><span data-stu-id="73f78-179">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="73f78-180">Ce statut signifie que le fichier est prêt pour l'importation.</span><span class="sxs-lookup"><span data-stu-id="73f78-180">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="73f78-181">**Importation** – Affecté automatiquement par un état électronique lorsque le fichier est verrouillé par le processus d'importation pour empêcher son utilisation par d'autres processus (si plusieurs d'entre eux sont exécutés simultanément).</span><span class="sxs-lookup"><span data-stu-id="73f78-181">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="73f78-182">**Importé** – Affecté automatiquement par un état électronique lorsque l'importation du fichier s'est déroulée correctement.</span><span class="sxs-lookup"><span data-stu-id="73f78-182">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="73f78-183">Ce statut signifie que le fichier importé a été supprimé de la source de fichier configurée (dossier SharePoint).</span><span class="sxs-lookup"><span data-stu-id="73f78-183">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="73f78-184">**Échec** – Affecté automatiquement par un état électronique lorsque l'importation du fichier s'est terminée avec des erreurs ou des exceptions.</span><span class="sxs-lookup"><span data-stu-id="73f78-184">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="73f78-185">**En attente** – Affecté manuellement par l'utilisateur dans cet écran.</span><span class="sxs-lookup"><span data-stu-id="73f78-185">**On hold** – Assigned manually by user on this form.</span></span> <span data-ttu-id="73f78-186">Ce statut signifie que le fichier n'est pas importé pour l'instant.</span><span class="sxs-lookup"><span data-stu-id="73f78-186">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="73f78-187">Ce statut peut être utilisé pour différer l'importation de certains fichiers.</span><span class="sxs-lookup"><span data-stu-id="73f78-187">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="73f78-188">[![Page d'états de fichier ER pour les sources sélectionnées](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="73f78-188">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="73f78-189">Importer des données à partir de fichiers SharePoint</span><span class="sxs-lookup"><span data-stu-id="73f78-189">Import data from SharePoint files</span></span>
1. <span data-ttu-id="73f78-190">Ouvrez l'arborescence des configurations ER, sélectionnez **Modèle de paiements de déclaration des honoraires**, puis développez la liste des composants de modèle ER.</span><span class="sxs-lookup"><span data-stu-id="73f78-190">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="73f78-191">Sélectionnez le nom de la mise en correspondance des modèles pour ouvrir la liste des mises en correspondance de modèles de la configuration de modèle ER sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="73f78-191">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="73f78-192">[![Page d'états de fichier ER pour les sources sélectionnées](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-192">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="73f78-193">Sélectionnez **Exécuter** pour exécuter la mise en correspondance des modèles sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="73f78-193">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="73f78-194">Comme vous avez configuré les sources de fichier pour le format ER, vous pouvez modifier le paramètre de l'option **Source de fichier** si besoin.</span><span class="sxs-lookup"><span data-stu-id="73f78-194">Because you configured file sources for the ER format, you can change the setting of the **File source** option as you require.</span></span> <span data-ttu-id="73f78-195">Si vous conservez le paramètre de cette option, les fichiers .xslx sont importés à partir des sources configurées (les dossiers SharePoint, dans cet exemple).</span><span class="sxs-lookup"><span data-stu-id="73f78-195">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="73f78-196">Dans cet exemple, vous n'importez qu'un seul fichier.</span><span class="sxs-lookup"><span data-stu-id="73f78-196">In this example, you're importing only one file.</span></span> <span data-ttu-id="73f78-197">Toutefois, s'il existe plusieurs fichiers, ils sont sélectionnés pour l'importation dans leur ordre d'ajout au dossier SharePoint.</span><span class="sxs-lookup"><span data-stu-id="73f78-197">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="73f78-198">Chaque exécution d'un format ER importe un fichier sélectionné unique.</span><span class="sxs-lookup"><span data-stu-id="73f78-198">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="73f78-199">[![Exécuter la mise en correspondance des modèles ER](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-199">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="73f78-200">La mise en correspondance des modèles peut s'exécuter sans assistance en mode de traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="73f78-200">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="73f78-201">Dans ce cas, chaque fois qu'un traitement par lots exécute ce format ER, un fichier unique est importé à partir des sources de fichier configurées.</span><span class="sxs-lookup"><span data-stu-id="73f78-201">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span> <span data-ttu-id="73f78-202">Utilisez le code suivant pour implémenter cette exécution du traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="73f78-202">Use the following code to implement this batch run.</span></span>

    ```
    ERObjectsFactory::createMappingDestinationRunByImportFormatMappingId().run()
    ```

    <span data-ttu-id="73f78-203">Lorsqu'un fichier est correctement importé à partir du dossier SharePoint, il est supprimé de celui-ci.</span><span class="sxs-lookup"><span data-stu-id="73f78-203">When a file is successfully imported from the SharePoint folder, it's deleted from that folder.</span></span>

5. <span data-ttu-id="73f78-204">Entrez l'ID du document, tel que **V-00001**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="73f78-204">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="73f78-205">[![Exécuter la mise en correspondance des modèles ER](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-205">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="73f78-206">Dans la page **États de fichier pour les sources**, sélectionnez **Actualiser** pour actualiser la page.</span><span class="sxs-lookup"><span data-stu-id="73f78-206">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="73f78-207">[![Page d'états de fichier ER pour les sources sélectionnées](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-207">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="73f78-208">Dans la section **Fichiers**, examinez la liste des fichiers.</span><span class="sxs-lookup"><span data-stu-id="73f78-208">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="73f78-209">La section **Journaux source pour le format d'importation** fournit l'historique de l'importation du fichier Excel.</span><span class="sxs-lookup"><span data-stu-id="73f78-209">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="73f78-210">Comme ce fichier a été correctement importé, il est marqué comme **Supprimé** dans le dossier SharePoint.</span><span class="sxs-lookup"><span data-stu-id="73f78-210">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="73f78-211">Examinez le dossier SharePoint **Source d'importation de fichiers (principale)**.</span><span class="sxs-lookup"><span data-stu-id="73f78-211">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="73f78-212">Les fichiers Excel qui ont été correctement importés ont été supprimés de ce dossier.</span><span class="sxs-lookup"><span data-stu-id="73f78-212">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="73f78-213">Dans Finance and Operations, sélectionnez **Comptabilité fournisseur** \> **Tâches périodiques** \> **Taxe sur les honoraires** \> **Règlement fournisseur pour les déclarations d'honoraires**.</span><span class="sxs-lookup"><span data-stu-id="73f78-213">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="73f78-214">Dans les champs **Date de début** et **Date de fin**, entrez les valeurs appropriées.</span><span class="sxs-lookup"><span data-stu-id="73f78-214">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="73f78-215">Sélectionnez ensuite **Transactions manuelles de déclaration d'honoraires**.</span><span class="sxs-lookup"><span data-stu-id="73f78-215">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="73f78-216">Les transactions fournisseur qui ont été importées à partir des fichiers Excel dans SharePoint pour le document **V-00001** sont affichées sur la page.</span><span class="sxs-lookup"><span data-stu-id="73f78-216">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="73f78-217">[![Page des transactions fournisseur de déclaration d'échanges de biens](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-217">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="73f78-218">Préparer un fichier Excel pour l'importation</span><span class="sxs-lookup"><span data-stu-id="73f78-218">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="73f78-219">Ouvrez le fichier Excel que vous avez précédemment utilisé.</span><span class="sxs-lookup"><span data-stu-id="73f78-219">Open the Excel file that you previously used.</span></span> <span data-ttu-id="73f78-220">Dans la ligne 3 colonne 1, ajoutez un code de fournisseur qui n'existe pas dans l'application.</span><span class="sxs-lookup"><span data-stu-id="73f78-220">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="73f78-221">Ajoutez des informations fournisseur supplémentaires à la ligne.</span><span class="sxs-lookup"><span data-stu-id="73f78-221">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="73f78-222">[![Exemple de fichier Microsoft Excel pour l'importation à partir de SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-222">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="73f78-223">Transférez le fichier Excel mis à jour contenant les transactions fournisseur vers le dossier SharePoint **Source d'importation de fichiers (principale)**.</span><span class="sxs-lookup"><span data-stu-id="73f78-223">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="73f78-224">Dans Finance and Operations, ouvrez l'arborescence des configurations ER, sélectionnez **Modèle de paiements de déclaration des honoraires**, puis développez la liste des composants de modèle ER.</span><span class="sxs-lookup"><span data-stu-id="73f78-224">In Finance and Operations, open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="73f78-225">Sélectionnez le nom de la mise en correspondance des modèles pour mettre à jour la mise en correspondance des modèles afin que le code fournisseur incorrect soit considéré comme une erreur au cours du processus d'importation.</span><span class="sxs-lookup"><span data-stu-id="73f78-225">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="73f78-226">Sélectionnez **Concepteur**.</span><span class="sxs-lookup"><span data-stu-id="73f78-226">Select **Designer**.</span></span>
6. <span data-ttu-id="73f78-227">Sous l'onglet **Validations**, vous devez modifier l'action de post-validation pour la règle de validation qui a été configurée pour évaluer si le compte fournisseur importé existe dans l'application.</span><span class="sxs-lookup"><span data-stu-id="73f78-227">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="73f78-228">Mettez à jour la valeur du champ **Action de post-validation** sur **Arrêter l'exécution**, enregistrez vos modifications, puis fermez la page.</span><span class="sxs-lookup"><span data-stu-id="73f78-228">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="73f78-229">[![Page du concepteur de mise en correspondance des modèles ER](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-229">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="73f78-230">Enregistrez vos modifications et fermez le concepteur de mise en correspondance des modèles ER.</span><span class="sxs-lookup"><span data-stu-id="73f78-230">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="73f78-231">Sélectionnez **Exécuter** pour exécuter la mise en correspondance des modèles ER modifiée.</span><span class="sxs-lookup"><span data-stu-id="73f78-231">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="73f78-232">Entrez l'ID du document, tel que **V-00002**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="73f78-232">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="73f78-233">Notez que la fenêtre Informations contient une notification informant que le fichier résidant dans le dossier SharePoint contient un compte fournisseur incorrect et ne peut pas être importé.</span><span class="sxs-lookup"><span data-stu-id="73f78-233">Note that the Infolog contains the notification informing that residing in SharePoint folder file contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="73f78-234">[![Exécuter la mise en correspondance des modèles ER](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-234">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="73f78-235">Dans la page **États de fichier pour les sources**, sélectionnez **Actualiser**, puis, dans la section **Fichiers**, examinez la liste des fichiers.</span><span class="sxs-lookup"><span data-stu-id="73f78-235">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="73f78-236">[![Page d'états de fichier ER pour les sources sélectionnées](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="73f78-236">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

    <span data-ttu-id="73f78-237">La section **Journaux source pour le format d'importation** indique que le processus d'importation a échoué et que le fichier se trouve toujours dans le dossier SharePoint (la case à cocher **Est supprimé** n'est pas sélectionnée).</span><span class="sxs-lookup"><span data-stu-id="73f78-237">The **Sources log for the import format** section indicates that the import process failed and that the file is still in the SharePoint folder (the **Is deleted** checkbox is not selected).</span></span> <span data-ttu-id="73f78-238">Si vous corrigez ce fichier dans SharePoint en ajoutant le code fournisseur correct, puis modifiez le statut du fichier de **Échec** à **Prêt** dans la section **Journaux source pour le format d'importation**, vous pouvez réimporter le fichier.</span><span class="sxs-lookup"><span data-stu-id="73f78-238">If you fix this file on SharePoint by adding the proper vendor code and then change the status of the file from **Failed** to **Ready** in the **Sources log for the import format** section, you can import the file again.</span></span>

11. <span data-ttu-id="73f78-239">Examinez le dossier SharePoint **Source d'importation de fichiers (principale)**.</span><span class="sxs-lookup"><span data-stu-id="73f78-239">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="73f78-240">Notez que le fichier Excel qui n'a pas été importé est toujours dans ce dossier.</span><span class="sxs-lookup"><span data-stu-id="73f78-240">Notice that the Excel file that wasn't imported is still in this folder.</span></span>
12. <span data-ttu-id="73f78-241">Dans Finance and Operations, sélectionnez **Comptabilité fournisseur** \> **Tâches périodiques** \> **Taxe sur les honoraires** \> **Règlement fournisseur pour les déclarations d'honoraires**, entrez les valeurs appropriées dans les champs **Date de début** et **Date de fin**, puis sélectionnez **Transactions manuelles de déclaration d'honoraires**.</span><span class="sxs-lookup"><span data-stu-id="73f78-241">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="73f78-242">Seules les transactions pour le document V-00001 sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="73f78-242">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="73f78-243">Aucune transaction pour le document V-00002 n'est disponible même si l'erreur pour la dernière transaction importée a été trouvée dans le fichier Excel.</span><span class="sxs-lookup"><span data-stu-id="73f78-243">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>

