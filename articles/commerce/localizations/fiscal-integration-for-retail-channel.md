---
title: Vue d'ensemble de l'intégration fiscale pour les canaux Commerce
description: Cette rubrique fournit une vue d'ensemble des capacités d'intégration fiscale disponibles dans Dynamics 365 Commerce.
author: josaw
manager: annbe
ms.date: 02/01/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailFunctionalityProfile, RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.search.region: Global
ms.search.industry: Retail
ms.author: v-kikozl
ms.search.validFrom: 2019-1-16
ms.dyn365.ops.version: 10
ms.openlocfilehash: d2455f775fcf41bbcb1388b2e8053ede8512335d
ms.sourcegitcommit: 199848e78df5cb7c439b001bdbe1ece963593cdb
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/13/2020
ms.locfileid: "4412362"
---
# <a name="overview-of-fiscal-integration-for-commerce-channels"></a><span data-ttu-id="027a4-103">Vue d'ensemble de l'intégration fiscale pour les canaux Commerce</span><span class="sxs-lookup"><span data-stu-id="027a4-103">Overview of fiscal integration for Commerce channels</span></span>

[!include [banner](../includes/banner.md)]

## <a name="introduction"></a><span data-ttu-id="027a4-104">Introduction</span><span class="sxs-lookup"><span data-stu-id="027a4-104">Introduction</span></span>

<span data-ttu-id="027a4-105">Cette rubrique présente une vue d'ensemble des capacités d'intégration fiscale disponibles dans Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="027a4-105">This topic is an overview of the fiscal integration capabilities that are available in Dynamics 365 Commerce.</span></span> <span data-ttu-id="027a4-106">L'intégration fiscale comprend l'intégration à différents périphériques et services fiscaux qui permettent l'enregistrement fiscal des ventes selon les lois fiscales locales dans le but de lutter contre la fraude fiscale dans le secteur de la vente au détail.</span><span class="sxs-lookup"><span data-stu-id="027a4-106">Fiscal integration includes integration with various fiscal devices and services that enable fiscal registration of sales in accordance with local fiscal laws that are aimed at preventing tax fraud in the retail industry.</span></span> <span data-ttu-id="027a4-107">Voici quelques scénarios traditionnels pouvant être couverts à l'aide de l'intégration fiscale :</span><span class="sxs-lookup"><span data-stu-id="027a4-107">Here are some typical scenarios that can be covered by using fiscal integration:</span></span>

- <span data-ttu-id="027a4-108">Enregistrez une vente sur un périphérique fiscal connecté à un point de vente (PDV), comme une imprimante fiscale et imprimez un reçu fiscal pour le client.</span><span class="sxs-lookup"><span data-stu-id="027a4-108">Register a sale on a fiscal device that is connected to point of sale (POS), such as a fiscal printer, and print a fiscal receipt for the customer.</span></span>
- <span data-ttu-id="027a4-109">Envoyez en toute sécurité des informations concernant les ventes et les retours exécutés dans Retail POS vers un service Web externe géré par l'administration fiscale.</span><span class="sxs-lookup"><span data-stu-id="027a4-109">Securely submit information that is related to sales and returns that are completed in Retail POS to an external web-service that is operated by the tax authority.</span></span>
- <span data-ttu-id="027a4-110">Assurez l'inaltérabilité des données de transaction commerciale via les signatures numériques.</span><span class="sxs-lookup"><span data-stu-id="027a4-110">Help guarantee inalterability of sales transaction data through digital signatures.</span></span>

<span data-ttu-id="027a4-111">La fonctionnalité d'intégration fiscale offre un cadre proposant une solution courante pour un développement poussé et une personnalisation de l'intégration entre Retail POS et les périphériques et services fiscaux.</span><span class="sxs-lookup"><span data-stu-id="027a4-111">The fiscal integration functionality is a framework that provides a common solution for further development and customization of the integration between Retail POS and fiscal devices and services.</span></span> <span data-ttu-id="027a4-112">La fonctionnalité comprend également des exemples d'intégration fiscale compatibles avec des scénarios de base pour des pays ou régions spécifiques, et qui fonctionnent avec des périphériques ou services fiscaux spécifiques.</span><span class="sxs-lookup"><span data-stu-id="027a4-112">The functionality also includes fiscal integration samples that support basic scenarios for specific countries or regions, and that work with specific fiscal devices or services.</span></span> <span data-ttu-id="027a4-113">Un exemple d'intégration fiscale est composé de plusieurs extensions de composants Commerce et est inclus dans le kit de développement logiciel (SDK).</span><span class="sxs-lookup"><span data-stu-id="027a4-113">A fiscal integration sample consists of several extensions of Commerce components and is included in the software development kit (SDK).</span></span> <span data-ttu-id="027a4-114">Pour plus d'informations sur les exemples d'intégration fiscale, voir [Exemples d'intégration fiscale dans le kit de développement logiciel Retail](#fiscal-integration-samples-in-the-retail-sdk).</span><span class="sxs-lookup"><span data-stu-id="027a4-114">For more information about the fiscal integration samples, see [Fiscal integration samples in the Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span></span> <span data-ttu-id="027a4-115">Pour en savoir plus sur la manière d'installer et d'utiliser le SDK de Retail, voir [Architecture du kit de développement logiciel de Retail](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span><span class="sxs-lookup"><span data-stu-id="027a4-115">For information about how to install and use the Retail SDK, see [Retail software development kit (SDK) architecture](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span></span>

<span data-ttu-id="027a4-116">Pour prendre en charge d'autres scénarios non compatibles avec un exemple d'intégration fiscale, pour intégrer Retail POS à d'autres périphériques ou services fiscaux, ou pour répondre aux exigences d'autres pays ou régions, vous devez développer un exemple d'intégration fiscale existant ou créer un exemple à l'aide d'un exemple existant.</span><span class="sxs-lookup"><span data-stu-id="027a4-116">To support other scenarios that aren't supported by a fiscal integration sample, to integrate Retail POS with other fiscal devices or services, or to cover requirements of other countries or regions, you must either extend an existing fiscal integration sample or create a new sample by using an existing sample as an example.</span></span>

## <a name="fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices"></a><span data-ttu-id="027a4-117">Processus d'enregistrement fiscal et exemples d'intégration fiscale pour les périphériques fiscaux</span><span class="sxs-lookup"><span data-stu-id="027a4-117">Fiscal registration process and fiscal integration samples for fiscal devices</span></span>

<span data-ttu-id="027a4-118">Un processus d'enregistrement fiscal dans Retail POS peut contenir une ou plusieurs étapes.</span><span class="sxs-lookup"><span data-stu-id="027a4-118">A fiscal registration process in Retail POS can consist of one or more steps.</span></span> <span data-ttu-id="027a4-119">Chaque étape implique l'enregistrement fiscal des transactions de vente spécifiques ou d'événements dans un périphérique ou service fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-119">Each step involves fiscal registration of specific transactions or events in one fiscal device or service.</span></span> <span data-ttu-id="027a4-120">Les composants de solution suivants participent à l'enregistrement fiscal dans un périphérique fiscal connecté à une station matérielle :</span><span class="sxs-lookup"><span data-stu-id="027a4-120">The following solution components participate in the fiscal registration in a fiscal device that is connected to a Hardware station:</span></span>

- <span data-ttu-id="027a4-121">**Extension de Commerce runtime (CRT)** – Ce composant sérialise les données de l'événement/transaction de vente au format également utilisé pour interagir avec le périphérique fiscal, analyse les réponses depuis le périphérique fiscal et stocke les réponses dans la base de données du canal.</span><span class="sxs-lookup"><span data-stu-id="027a4-121">**Commerce runtime (CRT) extension** – This component serializes transaction/event data in the format that is also used for interaction with the fiscal device, parses responses from the fiscal device, and stores the responses in the channel database.</span></span> <span data-ttu-id="027a4-122">L'extension définit également les transactions et les événements spécifiques qui doivent être enregistrés.</span><span class="sxs-lookup"><span data-stu-id="027a4-122">The extension also defines the specific transactions and events that must be registered.</span></span> <span data-ttu-id="027a4-123">Ce composant est souvent nommé *fournisseur de documents fiscaux*.</span><span class="sxs-lookup"><span data-stu-id="027a4-123">This component is often referred to as a *fiscal document provider*.</span></span>
- <span data-ttu-id="027a4-124">**Extension de station matérielle** – Ce composant lance la communication avec le périphérique fiscal, envoie des demandes et des commandes directes au périphérique fiscal selon les données de transaction/événement de vente extraites du document fiscal, et reçoit les réponses depuis le périphérique fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-124">**Hardware station extension** – This component initializes the communication with the fiscal device, sends requests and direct commands to the fiscal device based on the transaction/event data that is extracted from the fiscal document, and receives responses from the fiscal device.</span></span> <span data-ttu-id="027a4-125">Ce composant est souvent nommé *connecteur fiscal*.</span><span class="sxs-lookup"><span data-stu-id="027a4-125">This component is often referred to as a *fiscal connector*.</span></span>

<span data-ttu-id="027a4-126">Un exemple d'intégration fiscale pour un périphérique fiscal contient respectivement les extensions de station matérielle et CRT pour un fournisseur de documents fiscaux et un connecteur fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-126">A fiscal integration sample for a fiscal device contains the CRT and Hardware station extensions for a fiscal document provider and a fiscal connector, respectively.</span></span> <span data-ttu-id="027a4-127">Il contient également les configurations de composant suivantes :</span><span class="sxs-lookup"><span data-stu-id="027a4-127">It also contains the following component configurations:</span></span>

- <span data-ttu-id="027a4-128">**Configuration de fournisseur de documents fiscaux** – Cette configuration définit un mode de sortie et un format pour les documents fiscaux.</span><span class="sxs-lookup"><span data-stu-id="027a4-128">**Fiscal document provider configuration** – This configuration defines an output method and a format for fiscal documents.</span></span> <span data-ttu-id="027a4-129">Elle contient également une mise en correspondance des données pour les taxes et les modes de paiement, pour effectuer des paiements depuis Retail POS compatibles avec les valeurs prédéfinies dans le microgiciel du périphérique fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-129">It also contains a data mapping for taxes and payment methods, to make data from Retail POS compatible with the values that are predefined in the fiscal device firmware.</span></span>
- <span data-ttu-id="027a4-130">**Configuration de connecteur fiscal** – Cette configuration définit la communication physique avec le périphérique fiscal spécifique.</span><span class="sxs-lookup"><span data-stu-id="027a4-130">**Fiscal connector configuration** – This configuration defines the physical communication with the specific fiscal device.</span></span>

<span data-ttu-id="027a4-131">Un processus d'enregistrement fiscal pour un registre de PDV spécifique est défini par un paramètre correspondant dans le profil de fonctionnalité de PDV.</span><span class="sxs-lookup"><span data-stu-id="027a4-131">A fiscal registration process for a specific POS register is defined by a corresponding setting in the POS functionality profile.</span></span> <span data-ttu-id="027a4-132">Pour en savoir plus sur la manière de configurer un processus d'enregistrement fiscal, téléchargez le fournisseur de documents fiscaux et les configurations de connecteur fiscal, et modifiez leurs paramètres, voir [Configurer un processus d'enregistrement fiscal](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span><span class="sxs-lookup"><span data-stu-id="027a4-132">For more details about how to configure a fiscal registration process, upload fiscal document provider and fiscal connector configurations, and change their parameters, see [Set up a fiscal registration process](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span></span>

<span data-ttu-id="027a4-133">L'exemple suivant affiche un flux d'exécution d'enregistrement fiscal traditionnel pour un périphérique fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-133">The following example shows a typical fiscal registration execution flow for a fiscal device.</span></span> <span data-ttu-id="027a4-134">Le flux commence avec un événement dans le PDV (par exemple, la finalisation d'une transaction commerciale), et met en place la séquence suivante d'étapes :</span><span class="sxs-lookup"><span data-stu-id="027a4-134">The flow starts with an event in the POS (for example, finalization of a sales transaction) and implements the following sequence of steps:</span></span>

1. <span data-ttu-id="027a4-135">Le PDV demande un document fiscal depuis CRT.</span><span class="sxs-lookup"><span data-stu-id="027a4-135">The POS requests a fiscal document from CRT.</span></span>
2. <span data-ttu-id="027a4-136">CRT détermine si l'événement actuel exige un enregistrement fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-136">CRT determines whether the current event requires fiscal registration.</span></span>
3. <span data-ttu-id="027a4-137">Selon les paramètres de processus d'enregistrement fiscal, CRT identifie un connecteur fiscal et un fournisseur de documents fiscaux correspondant à utiliser pour l'enregistrement fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-137">Based on the fiscal registration process settings, CRT identifies a fiscal connector and corresponding fiscal document provider to use for the fiscal registration.</span></span>
4. <span data-ttu-id="027a4-138">CRT exécute le fournisseur de documents fiscaux qui génère un document fiscal (par exemple, un document XML) qui représente la transaction ou l'événement de vente.</span><span class="sxs-lookup"><span data-stu-id="027a4-138">CRT runs the fiscal document provider that generates a fiscal document (for example, an XML document) that represents the transaction or event.</span></span>
5. <span data-ttu-id="027a4-139">Le PDV envoie le document fiscal que CRT prépare pour une station matérielle.</span><span class="sxs-lookup"><span data-stu-id="027a4-139">The POS sends the fiscal document that CRT prepares to a Hardware station.</span></span>
6. <span data-ttu-id="027a4-140">La station matérielle exécute le connecteur fiscal qui traite le document fiscal et le communique au périphérique ou au service fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-140">The Hardware station runs the fiscal connector that processes the fiscal document and communicates it to the fiscal device or service.</span></span>
7. <span data-ttu-id="027a4-141">Le PDV analyse la réponse depuis le périphérique ou le service fiscal pour déterminer si l'enregistrement fiscal a réussi.</span><span class="sxs-lookup"><span data-stu-id="027a4-141">The POS analyzes the response from the fiscal device or service to determine whether the fiscal registration was successful.</span></span>
8. <span data-ttu-id="027a4-142">CRT enregistre la réponse vers la base de données du canal.</span><span class="sxs-lookup"><span data-stu-id="027a4-142">CRT saves the response to the channel database.</span></span>

<span data-ttu-id="027a4-143">![Schéma de solution](media/emea-fiscal-integration-solution.png "Schéma de solution")</span><span class="sxs-lookup"><span data-stu-id="027a4-143">![Solution schema](media/emea-fiscal-integration-solution.png "Solution schema")</span></span>

## <a name="error-handling"></a><span data-ttu-id="027a4-144">Gestion des erreurs</span><span class="sxs-lookup"><span data-stu-id="027a4-144">Error handling</span></span>

<span data-ttu-id="027a4-145">La structure d'intégration fiscale offre les options suivantes pour traiter les échecs lors d'un enregistrement fiscal :</span><span class="sxs-lookup"><span data-stu-id="027a4-145">The fiscal integration framework provides the following options to handle failures during fiscal registration:</span></span>

- <span data-ttu-id="027a4-146">**Réessayer** – Les opérateurs peuvent utiliser cette option si l'échec peut être rapidement résolu et si l'enregistrement fiscal peut être à nouveau exécuté.</span><span class="sxs-lookup"><span data-stu-id="027a4-146">**Retry** – Operators can use this option when the failure can be resolved quickly, and the fiscal registration can be rerun.</span></span> <span data-ttu-id="027a4-147">Par exemple, cette option peut être utilisée lorsque le périphérique fiscal n'est pas connecté, lorsque l'imprimante fiscale est à court de papier ou présente un bourrage papier.</span><span class="sxs-lookup"><span data-stu-id="027a4-147">For example, this option can be used when the fiscal device isn't connected, the fiscal printer is out of paper, or there is a paper jam in the fiscal printer.</span></span>
- <span data-ttu-id="027a4-148">**Annuler** – Cette option permet aux opérateurs de remettre à plus tard l'enregistrement fiscal de la transaction ou de l'événement actuel en cas d'échec éventuel.</span><span class="sxs-lookup"><span data-stu-id="027a4-148">**Cancel** – This option lets operators postpone the fiscal registration of the current transaction or event if it fails.</span></span> <span data-ttu-id="027a4-149">Une fois l'enregistrement remis à plus tard, l'opérateur peut continuer à travailler sur le PDV et terminer une opération pour laquelle l'enregistrement fiscal n'est pas requis.</span><span class="sxs-lookup"><span data-stu-id="027a4-149">After the registration is postponed, the operator can continue to work on the POS and can complete any operation that the fiscal registration isn't required for.</span></span> <span data-ttu-id="027a4-150">Lorsqu'un événement qui exige un enregistrement fiscal survient dans le PDV (par exemple, une nouvelle transaction est ouverte), la boîte de dialogue de traitement des erreurs s'ouvre automatiquement pour prévenir l'opérateur que la transaction précédente n'a pas été bien enregistrée et pour fournir les options de gestion des erreurs.</span><span class="sxs-lookup"><span data-stu-id="027a4-150">When any event that requires the fiscal registration occurs in the POS (for example, a new transaction is opened), the error handling dialog box automatically appears to notify the operator that the previous transaction wasn't correctly registered and to provide the error handling options.</span></span>
- <span data-ttu-id="027a4-151">**Ignorer** – Les opérateurs peuvent utiliser cette option si l'enregistrement fiscal peut être ignoré dans le cadre de conditions spécifiques et si les opérations habituelles peuvent se poursuivre dans le PDV.</span><span class="sxs-lookup"><span data-stu-id="027a4-151">**Skip** – Operators can use this option when the fiscal registration can be omitted under specific conditions and regular operations can be continued on the POS.</span></span> <span data-ttu-id="027a4-152">Par exemple, cette option peut être utilisée lorsqu'une transaction commerciale pour laquelle l'enregistrement fiscal a échoué peut être enregistrée dans un journal papier spécial.</span><span class="sxs-lookup"><span data-stu-id="027a4-152">For example, this option can be used when a sales transaction that the fiscal registration failed for can be registered in a special paper journal.</span></span>
- <span data-ttu-id="027a4-153">**Marquer comme enregistrée** – Les opérateurs peuvent utiliser cette option lorsque la transaction a été enregistrée réellement dans le périphérique fiscal (par exemple, un reçu fiscal a été imprimé), mais qu'un échec s'est produit lorsque la réponse fiscale a été enregistrée vers la base de données du canal.</span><span class="sxs-lookup"><span data-stu-id="027a4-153">**Mark as registered** – Operators can use this option when the transaction was actually registered in the fiscal device (for example, a fiscal receipt was printed), but a failure occurred when the fiscal response was being saved to the channel database.</span></span>

> [!NOTE]
> <span data-ttu-id="027a4-154">Les options **Ignorer** et **Marquer comme enregistrée** doivent être activées dans le processus d'enregistrement fiscal pour être utilisées.</span><span class="sxs-lookup"><span data-stu-id="027a4-154">The **Skip** and **Mark as registered** options must be activated in the fiscal registration process before they are used.</span></span> <span data-ttu-id="027a4-155">En outre, les autorisations correspondantes doivent être accordées aux opérateurs.</span><span class="sxs-lookup"><span data-stu-id="027a4-155">In addition, corresponding permissions must be granted to operators.</span></span>

<span data-ttu-id="027a4-156">Les options **Ignorer** et **Marquer comme enregistrée** permettent aux codes info de saisir certaines informations spécifiques concernant l'échec, comme la raison de l'échec ou la justification de l'omission de l'enregistrement fiscal ou du marquage de la transaction comme enregistrée.</span><span class="sxs-lookup"><span data-stu-id="027a4-156">The **Skip** and **Mark as registered** options enable info codes to capture some specific information about the failure, such as the reason for the failure or a justification for skipping the fiscal registration or marking the transaction as registered.</span></span> <span data-ttu-id="027a4-157">Pour en savoir plus sur la manière de configurer les paramètres de traitement des erreurs, voir [Définir les paramètres de traitement des erreurs](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="027a4-157">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="optional-fiscal-registration"></a><span data-ttu-id="027a4-158">Enregistrement fiscal facultatif</span><span class="sxs-lookup"><span data-stu-id="027a4-158">Optional fiscal registration</span></span>

<span data-ttu-id="027a4-159">L'enregistrement fiscal peut être obligatoire pour certaines opérations mais facultatif pour d'autres.</span><span class="sxs-lookup"><span data-stu-id="027a4-159">Fiscal registration might be mandatory for some operations but optional for others.</span></span> <span data-ttu-id="027a4-160">Par exemple, l'enregistrement fiscal des ventes et retours ordinaires peut être obligatoire, mais l'enregistrement fiscal des opérations associées à des dépôts client peut être facultatif.</span><span class="sxs-lookup"><span data-stu-id="027a4-160">For example, the fiscal registration of regular sales and returns might be mandatory, but the fiscal registration of operations that are related to customer deposits might be optional.</span></span> <span data-ttu-id="027a4-161">Dans ce cas, le manquement à réaliser l'enregistrement fiscal d'une vente bloquerait les ventes suivantes, mais le manquement à réaliser l'enregistrement fiscal d'un dépôt client ne bloquerait pas les ventes suivantes.</span><span class="sxs-lookup"><span data-stu-id="027a4-161">In this case, failure to complete the fiscal registration of a sale should block further sales, but failure to complete the fiscal registration of a customer deposit should not block further sales.</span></span> <span data-ttu-id="027a4-162">Pour distinguer les opérations obligatoires et facultatives, nous vous recommandons de les gérer via différents fournisseurs de document, et de configurer des étapes distinctes dans le processus d'enregistrement fiscal pour ces fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="027a4-162">To distinguish mandatory and optional operations, we recommend that you handle them through different document providers, and that you set up separate steps in the fiscal registration process for those providers.</span></span> <span data-ttu-id="027a4-163">Le paramètre **Continuer lors d'erreurs** doit être activé pour chaque étape liée à l'enregistrement fiscal facultatif.</span><span class="sxs-lookup"><span data-stu-id="027a4-163">The **Continue on error** parameter should be enabled for any step that is related to optional fiscal registration.</span></span> <span data-ttu-id="027a4-164">Pour en savoir plus sur la manière de configurer les paramètres de traitement des erreurs, voir [Définir les paramètres de traitement des erreurs](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="027a4-164">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="manually-running-fiscal-registration"></a><span data-ttu-id="027a4-165">Exécuter manuellement l'enregistrement fiscal</span><span class="sxs-lookup"><span data-stu-id="027a4-165">Manually running fiscal registration</span></span>

<span data-ttu-id="027a4-166">Si l'enregistrement fiscal d'une transaction ou d'un événement a été reporté après un échec (par exemple, si l'opérateur a sélectionné **Annuler** dans la boîte de dialogue de gestion des erreurs), vous pouvez relancer manuellement l'enregistrement fiscal en appelant une opération correspondante.</span><span class="sxs-lookup"><span data-stu-id="027a4-166">If the fiscal registration of a transaction or event has been postponed after a failure (for example, if the operator selected **Cancel** in the error handling dialog box), you can manually rerun the fiscal registration by invoking a corresponding operation.</span></span> <span data-ttu-id="027a4-167">Pour plus de détails, voir [Activer l'exécution manuelle d'un enregistrement fiscal reporté](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span><span class="sxs-lookup"><span data-stu-id="027a4-167">For more details, see [Enable manual execution of postponed fiscal registration](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span></span>

### <a name="fiscal-registration-health-check"></a><span data-ttu-id="027a4-168">Contrôle d'intégrité d'enregistrement fiscal</span><span class="sxs-lookup"><span data-stu-id="027a4-168">Fiscal registration health check</span></span>

<span data-ttu-id="027a4-169">La procédure de contrôle d'intégrité des enregistrements fiscaux vérifie la disponibilité du dispositif ou du service fiscal lorsque des événements spécifiques ont lieu.</span><span class="sxs-lookup"><span data-stu-id="027a4-169">The health check procedure for fiscal registrations verifies the availability of the fiscal device or service when specific events occur.</span></span> <span data-ttu-id="027a4-170">Si l'enregistrement fiscal ne peut actuellement pas être réalisé, l'opérateur en est averti par avance.</span><span class="sxs-lookup"><span data-stu-id="027a4-170">If the fiscal registration can't currently be completed, the operator is notified in advance.</span></span>

<span data-ttu-id="027a4-171">L'appareil de PDV exécute le contrôle d'intégrité lorsque les événements suivants se produisent :</span><span class="sxs-lookup"><span data-stu-id="027a4-171">The POS runs the health check when the following events occur:</span></span>

- <span data-ttu-id="027a4-172">Une nouvelle transaction est ouverte.</span><span class="sxs-lookup"><span data-stu-id="027a4-172">A new transaction is opened.</span></span>
- <span data-ttu-id="027a4-173">Une transaction en suspens est rappelée.</span><span class="sxs-lookup"><span data-stu-id="027a4-173">A suspended transaction is recalled.</span></span>
- <span data-ttu-id="027a4-174">Une transaction de vente ou de retour est finalisée.</span><span class="sxs-lookup"><span data-stu-id="027a4-174">A sales or return transaction is finalized.</span></span>

<span data-ttu-id="027a4-175">Si le contrôle d'intégrité échoue, l'appareil de PDV affiche la boîte de dialogue de contrôle d'intégrité.</span><span class="sxs-lookup"><span data-stu-id="027a4-175">If the health check fails, the POS shows the health check dialog box.</span></span> <span data-ttu-id="027a4-176">Cette boîte de dialogue contient les boutons suivants :</span><span class="sxs-lookup"><span data-stu-id="027a4-176">This dialog box provides the following buttons:</span></span>

- <span data-ttu-id="027a4-177">**OK** : ce bouton permet à l'opérateur d'ignorer une erreur de contrôle d'intégrité et de continuer à traiter l'opération.</span><span class="sxs-lookup"><span data-stu-id="027a4-177">**OK** – This button lets the operator ignore a health check error and continue to process the operation.</span></span> <span data-ttu-id="027a4-178">L'opérateur ne peut sélectionner ce bouton que si l'autorisation **Autoriser d'ignorer l'erreur du contrôle d'intégrité** est activée pour lui.</span><span class="sxs-lookup"><span data-stu-id="027a4-178">Operators can select this button only if the **Allow skip health check error** permission is enabled for them.</span></span>
- <span data-ttu-id="027a4-179">**Annuler** : si l'opérateur sélectionne ce bouton, l'appareil de PDV annule la dernière action (par exemple, un article n'est pas ajouté à une nouvelle transaction).</span><span class="sxs-lookup"><span data-stu-id="027a4-179">**Cancel** – If the operator selects this button, the POS cancels the last action (for example, an item isn't added to a new transaction).</span></span>

> [!NOTE]
> <span data-ttu-id="027a4-180">Le contrôle d'intégrité n'est effectué que si l'opération actuelle nécessite un enregistrement fiscal, et si le paramètre **Continuer lors d'erreurs** est désactivé pour l'étape actuelle du processus d'enregistrement fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-180">The health check is run only if the current operation requires fiscal registration, and if  the **Continue on error** parameter is disabled for the current step of the fiscal registration process.</span></span> <span data-ttu-id="027a4-181">Pour plus de détails, voir [Définir les paramètres de traitement des erreurs](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="027a4-181">For more details, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

## <a name="storing-fiscal-response-in-fiscal-transaction"></a><span data-ttu-id="027a4-182">Enregistrer la réponse fiscale dans la transaction fiscale</span><span class="sxs-lookup"><span data-stu-id="027a4-182">Storing fiscal response in fiscal transaction</span></span>

<span data-ttu-id="027a4-183">Si l'enregistrement fiscal d'une transaction ou d'un événement est une réussite, une transaction fiscale est créée dans la base de données du canal et associée à la transaction ou à l'événement d'origine.</span><span class="sxs-lookup"><span data-stu-id="027a4-183">When fiscal registration of a transaction or event is successful, a fiscal transaction is created in the channel database and linked to the original transaction or event.</span></span> <span data-ttu-id="027a4-184">De même, si l'option **Ignorer** ou **Marquer comme enregistrée** est activée pour un enregistrement fiscal ayant connu un échec, ces informations sont enregistrées dans une transaction fiscale.</span><span class="sxs-lookup"><span data-stu-id="027a4-184">Similarly, if the **Skip** or **Mark as registered** option is selected for a failed fiscal registration, this information is stored in a fiscal transaction.</span></span> <span data-ttu-id="027a4-185">Une transaction fiscale détient la réponse fiscale du périphérique ou du service fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-185">A fiscal transaction holds the fiscal response of the fiscal device or service.</span></span> <span data-ttu-id="027a4-186">Si le processus d'enregistrement fiscal est constitué de plusieurs étapes, une transaction fiscale est créée pour chaque étape du processus ayant résulté en un échec ou une réussite de l'enregistrement.</span><span class="sxs-lookup"><span data-stu-id="027a4-186">If the fiscal registration process consists of several steps, a fiscal transaction is created for each step of the process that resulted in a successful or failed registration.</span></span>

<span data-ttu-id="027a4-187">Les transactions fiscales sont transférées vers Headquarters par la *Tâche-P*, de même que les transactions de vente au détail.</span><span class="sxs-lookup"><span data-stu-id="027a4-187">Fiscal transactions are transferred to Headquarters by the *P-job*, together with transactions.</span></span> <span data-ttu-id="027a4-188">Dans l'organisateur **Transactions fiscales** de la page **Transactions de magasin**, vous pouvez afficher les transactions fiscales liées aux transactions de vente.</span><span class="sxs-lookup"><span data-stu-id="027a4-188">On the **Fiscal transactions** FastTab of the **Store transactions** page, you can view the fiscal transactions that are linked to transactions.</span></span>

<span data-ttu-id="027a4-189">Une transaction fiscale stocke les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="027a4-189">A fiscal transaction stores the following details:</span></span>

- <span data-ttu-id="027a4-190">Les détails du processus d'enregistrement fiscal (processus, groupe de connecteurs, connecteur, etc.).</span><span class="sxs-lookup"><span data-stu-id="027a4-190">Fiscal registration process details (process, connector group, connector, and so on).</span></span> <span data-ttu-id="027a4-191">Elle stocke également le numéro de série du périphérique fiscal dans le champ **Numéro de registre**, si ces informations sont incluses dans la réponse fiscale.</span><span class="sxs-lookup"><span data-stu-id="027a4-191">It also stores the serial number of the fiscal device in the **Register number** field, if this information is included in the fiscal response.</span></span>
- <span data-ttu-id="027a4-192">Le statut de l'enregistrement fiscal : **Terminé** pour un enregistrement réussi, **Ignoré** si l'opérateur a sélectionné l'option **Ignorer** pour un enregistrement échoué, ou **Marquée comme enregistrée** si l'opérateur a sélectionné l'option **Marquer comme enregistrée**.</span><span class="sxs-lookup"><span data-stu-id="027a4-192">The status of the fiscal registration: **Completed** for successful registration, **Skipped** if the operator selected the **Skip** option for a failed registration, or **Marked as registered** if the operator selected the **Mark as registered** option.</span></span>
- <span data-ttu-id="027a4-193">Les transactions de code d'informations associées à une transaction fiscale sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="027a4-193">Info code transactions that are related to a selected fiscal transaction.</span></span> <span data-ttu-id="027a4-194">Pour afficher les transactions de code d'informations, dans l'organisateur **Transactions fiscales**, sélectionnez une transaction fiscale dont le statut est défini sur **Ignoré** ou **Marquée comme enregistrée**, puis sélectionnez **Transactions de code info**.</span><span class="sxs-lookup"><span data-stu-id="027a4-194">To view the info code transactions, on the **Fiscal transactions** FastTab, select a fiscal transaction that has a status of **Skipped** or **Marked as registered**, and then select **Info code transactions**.</span></span>

## <a name="fiscal-texts-for-discounts"></a><span data-ttu-id="027a4-195">Textes fiscaux pour les remises</span><span class="sxs-lookup"><span data-stu-id="027a4-195">Fiscal texts for discounts</span></span>

<span data-ttu-id="027a4-196">Certains pays ou certaines régions ont des besoins spéciaux concernant des textes supplémentaires à imprimer sur des reçus fiscaux lorsque différents types de remises sont appliqués.</span><span class="sxs-lookup"><span data-stu-id="027a4-196">Some countries or regions have special requirements about additional texts that must be printed on fiscal receipts when different kinds of discounts are applied.</span></span> <span data-ttu-id="027a4-197">La fonctionnalité d'intégration fiscale vous permet de paramétrer un texte spécial pour une remise imprimée après une ligne de remise sur un reçu fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-197">The fiscal integration functionality lets you set up a special text for a discount that is printed after a discount line on a fiscal receipt.</span></span> <span data-ttu-id="027a4-198">Pour les remises manuelles, vous pouvez configurer un texte fiscal pour le code info spécifié comme code info **Remise de produit** dans le profil de fonctionnalité du PDV.</span><span class="sxs-lookup"><span data-stu-id="027a4-198">For manual discounts, you can configure a fiscal text for the info code that is specified as the **Product discount** info code in the POS functionality profile.</span></span> <span data-ttu-id="027a4-199">Pour plus de détails sur le paramétrage des textes fiscaux pour les remises, voir [Configurer les textes fiscaux pour les remises](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span><span class="sxs-lookup"><span data-stu-id="027a4-199">For more details about how to set up fiscal texts for discounts, see [Set up fiscal texts for discounts](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span></span>

## <a name="printing-fiscal-x-and-fiscal-z-reports"></a><span data-ttu-id="027a4-200">Impression des états fiscaux X/Z</span><span class="sxs-lookup"><span data-stu-id="027a4-200">Printing fiscal X and fiscal Z reports</span></span>

<span data-ttu-id="027a4-201">La fonctionnalité d'intégration fiscale prend en charge la génération des relevés de clôture de caisse qui sont spécifiques au périphérique ou au service fiscal intégré :</span><span class="sxs-lookup"><span data-stu-id="027a4-201">Fiscal integration functionality supports generation of end-of-day statements that are specific to the integrated fiscal device or service:</span></span>

- <span data-ttu-id="027a4-202">De nouveaux boutons qui exécutent des opérations correspondantes doivent être ajoutés à la mise en page de l'écran du PDV.</span><span class="sxs-lookup"><span data-stu-id="027a4-202">New buttons that run corresponding operations should be added to the POS screen layout.</span></span> <span data-ttu-id="027a4-203">Pour en savoir plus, voir [Configurer les états fiscaux X/Z depuis le PDV](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span><span class="sxs-lookup"><span data-stu-id="027a4-203">For more details, see [Set up fiscal X/Z reports from the POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span></span>
- <span data-ttu-id="027a4-204">Dans l'exemple d'intégration fiscale, ces opérations doivent être associées aux opérations correspondantes du périphérique fiscal.</span><span class="sxs-lookup"><span data-stu-id="027a4-204">In the fiscal integration sample, these operations should be matched to the corresponding operations of the fiscal device.</span></span>

## <a name="fiscal-integration-samples-in-the-retail-sdk"></a><span data-ttu-id="027a4-205">Exemples d'intégration fiscale dans le SDK de Retail</span><span class="sxs-lookup"><span data-stu-id="027a4-205">Fiscal integration samples in the Retail SDK</span></span>

<span data-ttu-id="027a4-206">Des exemples d'intégration fiscale sont actuellement disponibles dans le SDK de Retail :</span><span class="sxs-lookup"><span data-stu-id="027a4-206">The following fiscal integration samples are currently available in the Retail SDK:</span></span>

- [<span data-ttu-id="027a4-207">Exemple d'intégration de l'imprimante fiscale pour l'Italie</span><span class="sxs-lookup"><span data-stu-id="027a4-207">Fiscal printer integration sample for Italy</span></span>](emea-ita-fpi-sample.md)
- [<span data-ttu-id="027a4-208">Exemple d'intégration de l'imprimante fiscale pour la Pologne</span><span class="sxs-lookup"><span data-stu-id="027a4-208">Fiscal printer integration sample for Poland</span></span>](emea-pol-fpi-sample.md)
- [<span data-ttu-id="027a4-209">Exemple d'intégration du service d'enregistrement fiscal pour l'Australie</span><span class="sxs-lookup"><span data-stu-id="027a4-209">Fiscal registration service integration sample for Austria</span></span>](emea-aut-fi-sample.md)
- [<span data-ttu-id="027a4-210">Exemple d'intégration du service d'enregistrement fiscal pour la République tchèque</span><span class="sxs-lookup"><span data-stu-id="027a4-210">Fiscal registration service integration sample for Czech Republic</span></span>](emea-cze-fi-sample.md)
- [<span data-ttu-id="027a4-211">Exemple d'intégration de l'unité de contrôle pour la Suède</span><span class="sxs-lookup"><span data-stu-id="027a4-211">Control unit integration sample for Sweden</span></span>](./emea-swe-fi-sample.md)
- [<span data-ttu-id="027a4-212">Exemple d'intégration du service d'enregistrement fiscal pour l'Allemagne</span><span class="sxs-lookup"><span data-stu-id="027a4-212">Fiscal registration service integration sample for Germany</span></span>](./emea-deu-fi-sample.md)

<span data-ttu-id="027a4-213">La fonctionnalité d'intégration fiscale suivante est également disponible dans le SDK de Retail, mais ne bénéficie pas actuellement du cadre de l'intégration fiscale.</span><span class="sxs-lookup"><span data-stu-id="027a4-213">The following fiscal integration functionality is also available in the Retail SDK but doesn't currently take advantage of the fiscal integration framework.</span></span> <span data-ttu-id="027a4-214">La migration de cette fonctionnalité vers le cadre de l'intégration fiscale est prévue pour des mises à jour ultérieures.</span><span class="sxs-lookup"><span data-stu-id="027a4-214">Migration of this functionality to the fiscal integration framework is planned for later updates.</span></span>


- [<span data-ttu-id="027a4-215">Signature numérique pour la France</span><span class="sxs-lookup"><span data-stu-id="027a4-215">Digital signature for France</span></span>](emea-fra-cash-registers.md)
- [<span data-ttu-id="027a4-216">Signature numérique pour la Norvège</span><span class="sxs-lookup"><span data-stu-id="027a4-216">Digital signature for Norway</span></span>](emea-nor-cash-registers.md)

<span data-ttu-id="027a4-217">La fonctionnalité d'intégration fiscale héritée suivante, disponible dans le Kit de développement logiciel (SDK) Retail, n'utilise pas l'infrastructure d'intégration fiscale et sera rendue obsolète dans les mises à jour ultérieures :</span><span class="sxs-lookup"><span data-stu-id="027a4-217">The following legacy fiscal integration functionality that is available in Retail SDK does not use the fiscal integration framework and will be deprecated in later updates:</span></span>

- [<span data-ttu-id="027a4-218">Exemple d'intégration de l'unité de contrôle pour la Suède (hérité)</span><span class="sxs-lookup"><span data-stu-id="027a4-218">Control unit integration sample for Sweden (legacy)</span></span>](./retail-sdk-control-unit-sample.md)
