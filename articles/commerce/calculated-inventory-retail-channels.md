---
title: Calculer la disponibilité des stocks pour les canaux de vente au détail
description: Cette rubrique décrit comment une société peut utiliser Microsoft Dynamics 365 Commerce pour afficher la disponibilité estimée des produits dans les canaux en ligne et en magasin.
author: hhainesms
ms.date: 04/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: hhaines
ms.search.validFrom: 2020-02-11
ms.dyn365.ops.version: Release 10.0.10
ms.openlocfilehash: 96a600279b7a90d6626d23ee8868de13e9dd0f14
ms.sourcegitcommit: dc4898aa32f381620c517bf89c7856e693563ace
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/17/2021
ms.locfileid: "6270883"
---
# <a name="calculate-inventory-availability-for-retail-channels"></a><span data-ttu-id="5bc22-103">Calculer la disponibilité des stocks pour les canaux de vente au détail</span><span class="sxs-lookup"><span data-stu-id="5bc22-103">Calculate inventory availability for retail channels</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="5bc22-104">Cette rubrique décrit comment une société peut utiliser Microsoft Dynamics 365 Commerce pour afficher la disponibilité estimée des produits dans les canaux en ligne et en magasin.</span><span class="sxs-lookup"><span data-stu-id="5bc22-104">This topic describes how a company can use Microsoft Dynamics 365 Commerce to view estimated on-hand availability for products in the online and store channels.</span></span>

## <a name="accuracy-of-inventory-availability"></a><span data-ttu-id="5bc22-105">Précision de la disponibilité du stock</span><span class="sxs-lookup"><span data-stu-id="5bc22-105">Accuracy of inventory availability</span></span>

<span data-ttu-id="5bc22-106">Commerce utilise plusieurs serveurs et bases de données pour garantir l’évolutivité et les performances.</span><span class="sxs-lookup"><span data-stu-id="5bc22-106">Commerce uses multiple servers and databases to ensure scalability and performance.</span></span> <span data-ttu-id="5bc22-107">Par conséquent, il est important que vous compreniez que les valeurs de stock disponibles qui sont fournies via l’application de point de vente (PDV), les API de disponibilité du stock de commerce électronique et les pages de stock disponible dans Commerce Headquarters ne sont peut-être pas 100 %% précises en temps réel.</span><span class="sxs-lookup"><span data-stu-id="5bc22-107">Therefore, it's important that you understand that the available inventory values that are provided through the point of sale (POS) application, the e-commerce inventory availability application programming interfaces (APIs), and the on-hand inventory pages in Commerce headquarters might not be 100 percent accurate in real time.</span></span> <span data-ttu-id="5bc22-108">Si les transactions créées pour des produits dans le canal en ligne ou en magasin n’ont pas encore été synchronisées dans Commerce Headquarters, les pages du stock disponible dans Commerce Headquarters n’affichent peut-être pas une valeur de stock précise en temps réel pour ces produits.</span><span class="sxs-lookup"><span data-stu-id="5bc22-108">If transactions that are created for products in the online or store channel haven't yet been synced to headquarters, the on-hand inventory pages in headquarters might not show an accurate real-time inventory value for those products.</span></span> <span data-ttu-id="5bc22-109">Inversement, si vous avez configuré votre société de manière à ce que les utilisateurs de Commerce Headquarters ou d’autres applications incorporées puissent vendre, recevoir, retourner ou ajuster autrement le stock en dehors d’un magasin ou d’un entrepôt en ligne, le PDV ou le canal en ligne ne dispose peut-être pas de toutes les informations nécessaires pour afficher une valeur précise en temps réel pour les articles.</span><span class="sxs-lookup"><span data-stu-id="5bc22-109">Conversely, if you configured your company so that users in headquarters or other integrated applications can sell, receive, return, or otherwise adjust inventory out of a store or online warehouse, the POS or online channel might not have all the information that is required to show accurate real-time values for items.</span></span>

<span data-ttu-id="5bc22-110">Il est important que vous compreniez que toutes les données de disponibilité fournies au cours de la journée opérationnelle sont considérées comme une valeur estimée.</span><span class="sxs-lookup"><span data-stu-id="5bc22-110">It's critical to understand that all on-hand availability data that is provided during the operational day is considered an estimated value.</span></span> <span data-ttu-id="5bc22-111">Par conséquent, si vous essayez de comparer les informations sur le stock disponible fournies par l’application avec le stock physique réel dans les rayons, ou si vous essayez de comparer les valeurs disponibles affichées dans le PDV avec les données disponibles pour le même entrepôt dans Commerce Headquarters, les valeurs peuvent différer.</span><span class="sxs-lookup"><span data-stu-id="5bc22-111">Therefore, if you try to compare the on-hand inventory information that the application provides with actual physical inventory on the shelves, or if you try to compare the on-hand values that are shown in POS with the on-hand data that you find for the same warehouse in headquarters, the values might differ.</span></span> <span data-ttu-id="5bc22-112">Cette différence au cours de la journée opérationnelle est normale et ne doit pas être considérée comme un problème.</span><span class="sxs-lookup"><span data-stu-id="5bc22-112">This difference during the operational day is expected and should not be considered an issue.</span></span> <span data-ttu-id="5bc22-113">Si vous souhaitez auditer les données et vous assurer que les valeurs PDV et celles fournies dans les API et dans Commerce Headquarters correspondent aux unités physiques réelles disponibles dans les rayons de votre magasin ou de votre entrepôt, il est recommandé de le faire après l’arrêt des opérations du canal pour la journée et la synchronisation de toutes les transactions entre Commerce Headquarters et les canaux.</span><span class="sxs-lookup"><span data-stu-id="5bc22-113">If you want to audit data and make sure that the values provided in POS, APIs, and headquarters match the actual physical units that you find on your store or warehouse shelves, the best time to do it is after channel operations have stopped for the day and all transactions have been correctly synced between headquarters and the channels.</span></span>

## <a name="channel-side-inventory-calculation"></a><span data-ttu-id="5bc22-114">Calcul du stock côté canal</span><span class="sxs-lookup"><span data-stu-id="5bc22-114">Channel-side inventory calculation</span></span>

<span data-ttu-id="5bc22-115">Le calcul du stock côté canal prend les dernières données de stock de canal connues dans Commerce Headquarters comme base de référence, puis prend en compte les changements de stock supplémentaires qui se sont produits côté canal et qui ne sont pas inclus dans cette base de référence pour calculer un stock estimé presque en temps réel.</span><span class="sxs-lookup"><span data-stu-id="5bc22-115">The channel-side inventory calculation is a mechanism that takes the last-known channel inventory data in Commerce headquarters as a baseline, and then factors in additional inventory changes that occurred on the channel side that aren't included in that baseline to calculate a near-real-time estimated on-hand inventory.</span></span> 

<span data-ttu-id="5bc22-116">Les modifications de stock suivantes sont actuellement prises en compte dans la logique de calcul du stock côté canal :</span><span class="sxs-lookup"><span data-stu-id="5bc22-116">The following inventory changes are currently considered in the channel-side inventory calculation logic:</span></span>

- <span data-ttu-id="5bc22-117">Stock vendu par le biais de commandes au comptant sans livraison</span><span class="sxs-lookup"><span data-stu-id="5bc22-117">Inventory sold through cash-and-carry orders in store</span></span>
- <span data-ttu-id="5bc22-118">Stock vendu par le biais de commandes de clients en magasin ou sur le canal en ligne</span><span class="sxs-lookup"><span data-stu-id="5bc22-118">Inventory sold through customer orders in store or online channel</span></span>
- <span data-ttu-id="5bc22-119">Stock retourné au magasin</span><span class="sxs-lookup"><span data-stu-id="5bc22-119">Inventory returned to store</span></span>
- <span data-ttu-id="5bc22-120">Stock traité (prélèvement, emballage, expédition) depuis l’entrepôt du magasin</span><span class="sxs-lookup"><span data-stu-id="5bc22-120">Inventory fulfilled (pick, pack, ship) from store warehouse</span></span>

<span data-ttu-id="5bc22-121">Pour utiliser le calcul du stock côté canal, comme condition préalable, un instantané périodique des données d’inventaire du siège créé par la tâche **Disponibilité du produit** doit être envoyé aux bases de données de canal.</span><span class="sxs-lookup"><span data-stu-id="5bc22-121">To use the channel-side inventory calculation, as a prerequisite a periodic snapshot of inventory data from headquarters created by the **Product availability** job must be sent to the channel databases.</span></span> <span data-ttu-id="5bc22-122">L’instantané représente les informations dont Commerce Headquarters dispose sur la disponibilité du stock pour une combinaison spécifique d’un produit ou d’une variante de produit et d’un entrepôt.</span><span class="sxs-lookup"><span data-stu-id="5bc22-122">The snapshot represents the information that headquarters has about inventory availability for a specific combination of a product or product variant and a warehouse.</span></span> <span data-ttu-id="5bc22-123">Il inclut uniquement les transactions d’inventaire qui ont été traitées et publiées dans Commerce Headquarters au moment où l’instantané a été pris, et il peut ne pas être précis à 100 %% en temps réel en raison du traitement constant des ventes qui se produit sur les serveurs distribués.</span><span class="sxs-lookup"><span data-stu-id="5bc22-123">It includes only the inventory transactions that were processed and posted in headquarters at the time when the snapshot was taken, and it might not be 100 percent accurate in real time because of the constant sales processing that occurs across distributed servers.</span></span>

- <span data-ttu-id="5bc22-124">Si le stock a été vendu pour un produit dans un magasin par le biais d’une commande client au comptant sans livraison ou asynchrone dans l’application PDV, Commerce Headquarters ne dispose pas immédiatement d’informations sur la transaction de sortie de stock associée pour la vente.</span><span class="sxs-lookup"><span data-stu-id="5bc22-124">If inventory was sold for a product in a store through a cash-and-carry or asynchronous customer order sale in the POS application, headquarters won't immediately have information about the related inventory issue transaction for the sale.</span></span> <span data-ttu-id="5bc22-125">Commerce Headquarters fournit les informations sur le stock vendu pour ces types de vente en magasin uniquement une fois que la tâche P charge la transaction associée depuis la base de données du canal du magasin et que les commandes clients associées sont créée par validation du relevé ou via les processus de validation en flux continu.</span><span class="sxs-lookup"><span data-stu-id="5bc22-125">Headquarters will have information about the inventory that is sold for these types of store sales only after the P-job uploads the related transaction from the store's channel database into headquarters and the related sales orders are created through statement posting or the trickle feed posting processes.</span></span> <span data-ttu-id="5bc22-126">Le processus de création des commandes dans Commerce Headquarters crée les transactions de stock associées.</span><span class="sxs-lookup"><span data-stu-id="5bc22-126">The process of creating the orders in headquarters creates the related inventory transactions.</span></span> 
- <span data-ttu-id="5bc22-127">Pour les commandes du canal de commerce électronique, Commerce Headquarters dispose d’informations sur les transactions de stock une fois que les transactions sont envoyées à Commerce Headquarters via la tâche P et que le processus de synchronisation des commandes est terminé.</span><span class="sxs-lookup"><span data-stu-id="5bc22-127">For e-commerce channel orders, headquarters has information about the inventory transactions only after the transactions are sent to headquarters through the P-job and the order synchronization process is completed.</span></span>

<span data-ttu-id="5bc22-128">Pour prendre un instantané du stock dans Commerce Headquarters, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="5bc22-128">To take a snapshot of inventory in Commerce headquarters, follow these steps.</span></span>

1. <span data-ttu-id="5bc22-129">Accédez à **Commerce et vente au détail \> IT vente au détail et commerce \> Produits et stock \> Disponibilité du produit**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-129">Go to **Retail and Commerce \> Retail and Commerce IT \> Products and inventory \> Product availability**.</span></span>
1. <span data-ttu-id="5bc22-130">Cliquez sur **OK** pour exécuter la tâche **Disponibilité du produit**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-130">Select **OK** to run the **Product availability** job.</span></span> <span data-ttu-id="5bc22-131">Vous pouvez également planifier cette tâche pour qu’elle soit exécutée en mode de traitement par lots.</span><span class="sxs-lookup"><span data-stu-id="5bc22-131">You can also schedule this job to run in batch.</span></span>

<span data-ttu-id="5bc22-132">Une fois l’exécution de la tâche **Disponibilité du produit** terminée, les données capturées doivent être envoyées vers les bases de données du canal de commerce électronique, afin que le dernier instantané du stock de Commerce Headquarters puisse être pris en compte dans le calcul côté canal du stock disponible estimé.</span><span class="sxs-lookup"><span data-stu-id="5bc22-132">After the **Product availability** job has finished running, the data that was captured must be pushed to the channel databases, so that the latest headquarters inventory snapshot can be considered in the channel-side calculation of estimated on-hand inventory.</span></span>

<span data-ttu-id="5bc22-133">Pour synchroniser les données de l’instantané de Commerce Headquarters avec les bases de données de vos canaux, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="5bc22-133">To sync snapshot data from headquarters to your channel databases, follow these steps.</span></span>

1. <span data-ttu-id="5bc22-134">Accédez à **Commerce et vente au détail \> Informatique Commerce et vente au détail \> Programme de distribution**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-134">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="5bc22-135">Exécutez la tâche **1130** (**Disponibilité du produit**) pour synchroniser les données d’instantané créées par la tâche **Disponibilité du produit** entre Commerce Headquarters et les bases de données du canal.</span><span class="sxs-lookup"><span data-stu-id="5bc22-135">Run the **1130** (**Product availability**) job to sync the snapshot data that the **Product availability** job has created from headquarters to your channel databases.</span></span>

## <a name="inventory-availability-apis-for-e-commerce"></a><span data-ttu-id="5bc22-136">API de disponibilité de stock pour le commerce électronique</span><span class="sxs-lookup"><span data-stu-id="5bc22-136">Inventory availability APIs for e-commerce</span></span>

<span data-ttu-id="5bc22-137">Commerce fournit les API suivantes pour les scénarios de commerce électronique afin d’interroger la disponibilité du stock d’un produit :</span><span class="sxs-lookup"><span data-stu-id="5bc22-137">Commerce provides the following APIs for e-commerce scenarios to query inventory availability of a product:</span></span>

- <span data-ttu-id="5bc22-138">**GetEstimatedAvailability** – Utilisez cette API pour interroger le stock d’un produit ou d’une variante de produit dans l’entrepôt ou les entrepôts du canal en ligne qui sont liés au groupe de traitement du canal en ligne.</span><span class="sxs-lookup"><span data-stu-id="5bc22-138">**GetEstimatedAvailability** – Use this API to query inventory for a product or product variant in the online channel warehouse or warehouses that are linked to the online channel's fulfillment group.</span></span>
- <span data-ttu-id="5bc22-139">**GetEstimatedProductWarehouseAvailability** – Utilisez cette API pour demander le stock d’un produit ou d’une variante de produit dans un entrepôt spécifique.</span><span class="sxs-lookup"><span data-stu-id="5bc22-139">**GetEstimatedProductWarehouseAvailability** – Use this API to query inventory for a product or product variant from a specific warehouse.</span></span>

> [!NOTE]
> <span data-ttu-id="5bc22-140">Ces API remplacent les API **GetProductAvailabilities** et **GetAvailableInventoryNearby** dans Commerce version 10.0.7 et versions antérieures.</span><span class="sxs-lookup"><span data-stu-id="5bc22-140">These APIs replace the **GetProductAvailabilities** and **GetAvailableInventoryNearby** APIs in Commerce release 10.0.7 and earlier.</span></span>

<span data-ttu-id="5bc22-141">Les deux API utilisent en interne la logique de calcul côté canal et retournent une estimation de la quantité **physique disponible**, de la quantité **totale disponible**, de l’**unité de mesure (UoM)**, et du **niveau de stock** pour le produit et l’entrepôt demandés.</span><span class="sxs-lookup"><span data-stu-id="5bc22-141">Both APIs internally use the channel-side calculation logic and return estimated **physical available** quantity, **total available** quantity, **unit of measure (UoM)**, and **inventory level** for the requested product and warehouse.</span></span> <span data-ttu-id="5bc22-142">Les valeurs retournées peuvent être affichées sur votre site de commerce électronique si vous le souhaitez, ou elles peuvent être utilisées pour déclencher une autre logique métier sur votre site de commerce électronique.</span><span class="sxs-lookup"><span data-stu-id="5bc22-142">The returned values can be shown on your e-commerce site if you want, or they can be used to trigger other business logic on your e-commerce site.</span></span> <span data-ttu-id="5bc22-143">Par exemple, vous pouvez empêcher l’achat de produits avec un niveau « rupture de stock ».</span><span class="sxs-lookup"><span data-stu-id="5bc22-143">For example, you can prevent the purchase of products with an "out of stock" inventory level.</span></span>

<span data-ttu-id="5bc22-144">Bien que les autres API disponibles sur Commerce puissent accéder directement à Commerce Headquarters pour extraire les quantités disponibles des produits, il est déconseillé de les utiliser dans un environnement de commerce électronique en raison des problèmes potentiels de performances et de l’impact que ces demandes fréquentes peuvent avoir sur vos serveurs Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="5bc22-144">Although other APIs that are available in Commerce can go directly to headquarters to fetch on-hand quantities for products, we don't recommend that they be used in an e-commerce environment because of potential performance issues and the impact that these frequent requests can have on your headquarters servers.</span></span> <span data-ttu-id="5bc22-145">De plus, avec le calcul côté canal, les deux API mentionnées ci-dessus peuvent fournir une estimation plus précise de la disponibilité d’un produit en tenant compte des transactions créées dans les canaux qui ne sont pas encore connues de Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="5bc22-145">Additionally, with channel-side calculation, the two APIs mentioned above can provide a more accurate estimate of a product's availability by taking into account the transactions created in the channels that aren’t yet known to headquarters.</span></span>

<span data-ttu-id="5bc22-146">Pour utiliser les deux API mentionnées précédemment, vous devez activer la fonctionnalité **Calcul de la disponibilité des produits optimisée** via l’espace de travail **Gestion des fonctionnalités** dans Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="5bc22-146">To use the two APIs, you must enable the **Optimized product availability calculation** feature through the **Feature management** workspace in headquarters.</span></span> <span data-ttu-id="5bc22-147">Si vos canaux en ligne et en magasin utilisent les mêmes entrepôts de traitement des commandes, vous devez également activer la fonctionnalité **Amélioration de la logique de calcul des stocks côté canal du commerce électronique** qui fournit la logique de calcul côté canal aux deux API pour prendre en compte les transactions non comptabilisées (transactions au comptant sans livraison, commandes client, retours) créées dans le canal de magasin.</span><span class="sxs-lookup"><span data-stu-id="5bc22-147">If your online and store channels use the same fulfillment warehouses, you must also enable the **Enhanced e-Commerce channel-side inventory calculation logic** feature to have the channel-side calculation logic within the two APIs to factor in the unposted transactions (cash-and-carry, customer orders, returns) created in the store channel.</span></span> <span data-ttu-id="5bc22-148">Vous devrez exécuter la tâche **1070** (**Configuration du canal**) après avoir activé ces fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="5bc22-148">You will need to run the **1070** (**Channel configuration**) job after enabling these features.</span></span>

<span data-ttu-id="5bc22-149">Pour définir la manière dont la quantité de produit doit être retournée dans le résultat de l’API, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="5bc22-149">To define how product quantity should be returned in the API output, follow these steps.</span></span>

1. <span data-ttu-id="5bc22-150">Accédez à **Retail et Commerce \> Configuration du siège \> Paramètres \> Paramètres commerciaux**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-150">Go to **Retail and Commerce \> Headquarters setup \> Parameters \> Commerce parameters**.</span></span>
1. <span data-ttu-id="5bc22-151">Sélectionnez l’onglet **Stock**, puis sur le raccourci **API de disponibilité de stock pour le commerce électronique** configurez la valeur du paramètre **Quantité dans le résultat de l’API**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-151">Select the **Inventory** tab, and then on the **Inventory availability APIs for e-Commerce** FastTab configure the value of the **Quantity in API output** setting.</span></span>
1. <span data-ttu-id="5bc22-152">Exécutez la tâche **1070** (**Configuration du canal**) pour synchroniser le nouveau paramètre entre les canaux.</span><span class="sxs-lookup"><span data-stu-id="5bc22-152">Run the **1070** (**Channel configuration**) job to sync the latest setting to channels.</span></span>

<span data-ttu-id="5bc22-153">Le paramètre **Quantité dans le résultat de l’API** propose trois options :</span><span class="sxs-lookup"><span data-stu-id="5bc22-153">The **Quantity in API output** setting provides three options:</span></span>

- <span data-ttu-id="5bc22-154">**Renvoyer la quantité de stock** – La quantité physique disponible et la quantité totale disponible d’un produit demandé sont renvoyées dans le résultat de l’API.</span><span class="sxs-lookup"><span data-stu-id="5bc22-154">**Return inventory quantity** - Physical available and total available quantity of a requested product are returned in API output.</span></span>
- <span data-ttu-id="5bc22-155">**Renvoyer la quantité de stock en soustrayant la marge de stock** – La quantité renvoyée dans le résultat de l’API est ajustée en soustrayant la valeur de la marge de stock.</span><span class="sxs-lookup"><span data-stu-id="5bc22-155">**Return inventory quantity subtracting inventory buffer** - The quantity returned in the API output is adjusted by subtracting the inventory buffer value.</span></span> <span data-ttu-id="5bc22-156">Pour plus d’informations sur la marge de stock, consultez [Configurer des marges de stock et des niveaux de stock](inventory-buffers-levels.md).</span><span class="sxs-lookup"><span data-stu-id="5bc22-156">For more information about the inventory buffer, see [Configure inventory buffers and inventory levels](inventory-buffers-levels.md).</span></span>
- <span data-ttu-id="5bc22-157">**Ne pas retourner la quantité de stock** – Seul le niveau de stock est renvoyé dans le résultat de l’API.</span><span class="sxs-lookup"><span data-stu-id="5bc22-157">**Not return inventory quantity** - Only the inventory level is returned in the API output.</span></span> <span data-ttu-id="5bc22-158">Pour plus d’informations sur les niveaux de stock, consultez [Configurer des marges de stock et des niveaux de stock](inventory-buffers-levels.md).</span><span class="sxs-lookup"><span data-stu-id="5bc22-158">For more information about inventory levels, see [Configure inventory buffers and inventory levels](inventory-buffers-levels.md).</span></span>

<span data-ttu-id="5bc22-159">Vous pouvez utiliser le paramètre d’API `QuantityUnitTypeValue` pour spécifier le type d’unité pour la quantité renvoyée par l’API.</span><span class="sxs-lookup"><span data-stu-id="5bc22-159">You can use the `QuantityUnitTypeValue` API parameter to specify the unit type in which you would like the APIs to return quantity.</span></span> <span data-ttu-id="5bc22-160">Ce paramètre prend en charge les options **unité de stock** (par défaut), **unité d’achat** et **unité de vente**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-160">This parameter supports the **inventory unit** (default), **purchase unit**, and **sell unit** options.</span></span> <span data-ttu-id="5bc22-161">La quantité retournée est arrondie à la précision définie de l’unité de mesure (UdM) correspondante dans Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="5bc22-161">The returned quantity is rounded to the defined precision of the corresponding unit of measure (UOM) in headquarters.</span></span>

<span data-ttu-id="5bc22-162">L’API **GetEstimatedAvailability** propose les paramètres d’entrée suivants pour prendre en charge différents scénarios de requête :</span><span class="sxs-lookup"><span data-stu-id="5bc22-162">The **GetEstimatedAvailability** API offers the following input parameters to support different query scenarios:</span></span>

- <span data-ttu-id="5bc22-163">`DefaultWarehouseOnly` – Utilisez ce paramètre pour interroger le stock d’un produit dans l’entrepôt par défaut du canal en ligne.</span><span class="sxs-lookup"><span data-stu-id="5bc22-163">`DefaultWarehouseOnly` - Use this parameter to query inventory for a product in the online channel's default warehouse.</span></span> 
- <span data-ttu-id="5bc22-164">`FilterByChannelFulfillmentGroup` et `SearchArea` – Utilisez ces deux paramètres pour interroger le stock d’un produit à partir de tous les lieux de collecte dans une zone de recherche spécifique, en fonction des données `longitude`, `latitude` et `radius`.</span><span class="sxs-lookup"><span data-stu-id="5bc22-164">`FilterByChannelFulfillmentGroup` and `SearchArea` - Use these two parameters to query inventory for a product from all pickup locations within a specific search area, based on `longitude`, `latitude`, and `radius`.</span></span> 
- <span data-ttu-id="5bc22-165">`FilterByChannelFulfillmentGroup` et `DeliveryModeTypeFilterValue` – Utilisez ces deux paramètres pour interroger le stock d’un produit dans des entrepôts spécifiques qui sont liés au groupe de traitement d’un canal en ligne et sont configurés pour prendre en charge certains modes de livraison.</span><span class="sxs-lookup"><span data-stu-id="5bc22-165">`FilterByChannelFulfillmentGroup` and `DeliveryModeTypeFilterValue` - Use these two parameters to query inventory for a product from specific warehouses that are linked to an online channel's fulfillment group and are configured to support certain modes of delivery.</span></span> <span data-ttu-id="5bc22-166">Le paramètre `DeliveryModeTypeFilterValue` prend en charge les options **tout** (par défaut), **expédition**, et **prélèvement**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-166">The `DeliveryModeTypeFilterValue` parameter supports the **all** (default), **shipping**, and **pickup** options.</span></span> <span data-ttu-id="5bc22-167">Par exemple, dans un scénario où une commande en ligne peut être exécutée à partir de plusieurs entrepôts d’expédition, vous pouvez utiliser ces deux paramètres pour interroger la disponibilité du stock d’un produit dans tous ces entrepôts d’expédition.</span><span class="sxs-lookup"><span data-stu-id="5bc22-167">For example, in a scenario where an online order can be fulfilled from multiple shipping warehouses, you can use these two parameters to query a product's inventory availability in all of those shipping warehouses.</span></span> <span data-ttu-id="5bc22-168">Dans ce cas, l’API renvoie la quantité disponible et le niveau de stock du produit dans chacun des entrepôts d’expédition, ainsi qu’une quantité agrégée et un niveau de stock agrégé de tous les entrepôts d’expédition dans la portée de la requête.</span><span class="sxs-lookup"><span data-stu-id="5bc22-168">The API in this case returns the product's on-hand quantity and inventory level in each of the shipping warehouses, plus an aggregated quantity and an aggregated inventory level from all shipping warehouses in the query scope.</span></span>
 
<span data-ttu-id="5bc22-169">Les modules de zone d’achat, de sélecteur de magasin, de liste de souhaits, de panier et d’icône de panier de Commerce utilisent les API et les paramètres mentionnés ci-dessus pour afficher les messages de niveau de stock sur le site de commerce électronique.</span><span class="sxs-lookup"><span data-stu-id="5bc22-169">The Commerce buy box, store selector, wishlist, cart, and cart icon modules consume the APIs and parameters mentioned above to display inventory level messages across the e-commerce site.</span></span> <span data-ttu-id="5bc22-170">Le générateur du site Commerce fournit divers paramètres de stock pour contrôler le merchandising et le comportement d’achat.</span><span class="sxs-lookup"><span data-stu-id="5bc22-170">Commerce site builder provides various inventory settings to control merchandising and purchase behavior.</span></span> <span data-ttu-id="5bc22-171">Pour plus d’informations, voir [Appliquer les paramètres de stock](inventory-settings.md).</span><span class="sxs-lookup"><span data-stu-id="5bc22-171">For more information, see [Apply inventory settings](inventory-settings.md).</span></span>

## <a name="pos-inventory-lookup-with-channel-side-calculation"></a><span data-ttu-id="5bc22-172">Recherche de stock de point de vente avec calcul côté canal</span><span class="sxs-lookup"><span data-stu-id="5bc22-172">POS inventory lookup with channel-side calculation</span></span>

<span data-ttu-id="5bc22-173">Dans Commerce version 10.0.9 et les versions antérieures, l’opération **Recherche de stock** dans le PDV utilisait un appel de service en temps réel vers Commerce Headquarters pour obtenir des informations sur le stock pour le produit sélectionné, pour le magasin actuel de l’utilisateur et les autres magasins configurés pour le groupe d’exécution dans le cadre de la configuration du canal pour le magasin.</span><span class="sxs-lookup"><span data-stu-id="5bc22-173">In the Commerce release 10.0.9 and earlier, the **Inventory lookup** operation in POS used a real-time service call to headquarters to get inventory information for the selected product for both the user's current store and any other stores that are configured for the fulfillment group as part of the channel configuration for the store.</span></span> <span data-ttu-id="5bc22-174">Dans Commerce version 10.0.10 et les versions ultérieures, vous pouvez désactiver les appels de service en temps réel à Commerce Headquarters et utiliser à la place le calcul côté canal sur le serveur Commerce pour déterminer le stock physiquement disponible dans le magasin et tout autre emplacement défini dans le groupe de traitement.</span><span class="sxs-lookup"><span data-stu-id="5bc22-174">In Commerce release 10.0.10 and later, you can turn off real-time service calls to headquarters and instead use channel-side calculation on the Commerce server to determine the on-hand inventory that is physically available for the store and any other locations that are defined in the fulfillment group.</span></span> <span data-ttu-id="5bc22-175">Cette configuration du stock calculé par le canal est également utile pour les emplacements où la connectivité Internet n’est pas fiable, car vous n’avez pas besoin d’être en ligne pour accéder aux recherches de stock dans Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="5bc22-175">This channel-calculated inventory configuration is also useful for locations where internet connectivity is unreliable, because you don't have to be online to get inventory lookups headquarters.</span></span>

<span data-ttu-id="5bc22-176">Lorsque le calcul côté canal est correctement configuré et géré, il peut fournir une estimation plus fiable du stock actuel du magasin, car il utilise les données transactionnelles disponibles dans la base de données du canal Commerce, mais pour lesquelles Commerce Headquarters ne dispose peut-être pas encore d’informations.</span><span class="sxs-lookup"><span data-stu-id="5bc22-176">When channel-side calculation is correctly configured and managed, it can provide a more reliable estimate of the current store inventory because it uses the transactional data that is in the Commerce channel database but that headquarters might not yet have information about.</span></span> <span data-ttu-id="5bc22-177">Par exemple, si vous utilisez l’appel de service en temps réel existant pour les recherches de stock dans le PDV, Commerce Headquarters ne dispose probablement pas encore d’informations sur une vente au comptant sans livraison qui vient d’être effectuée pour un produit.</span><span class="sxs-lookup"><span data-stu-id="5bc22-177">For example, if you use the existing real-time service call for inventory lookups in POS, headquarters probably won't yet have information about a cash-and-carry sale that just occurred for a product.</span></span> <span data-ttu-id="5bc22-178">Par conséquent, la valeur du stock disponible renvoyée par Commerce Headquarters pour ce produit dépasse probablement d’une unité le stock réel disponible du magasin.</span><span class="sxs-lookup"><span data-stu-id="5bc22-178">Therefore, the on-hand inventory value that headquarters returns for that product will probably exceed the store's actual on-hand inventory by one unit.</span></span> <span data-ttu-id="5bc22-179">Toutefois, si vous utilisez le calcul côté canal, la vente au comptant sans livraison peut être prise en compte dans le calcul et déduite de la valeur disponible affichée.</span><span class="sxs-lookup"><span data-stu-id="5bc22-179">However, if you use channel-side calculation, the cash-and-carry sale can be factored into the calculation and deducted from the on-hand value that is shown.</span></span> <span data-ttu-id="5bc22-180">Bien que les valeurs fournies par le calcul côté canal et l’appel de service en temps réel ne soient que des estimations du stock disponible, la valeur fournie par le calcul côté canal est plus susceptible d’être précise pour le magasin actuel.</span><span class="sxs-lookup"><span data-stu-id="5bc22-180">Although the values that both the channel-side calculation and the real-time service call provide are only estimates of on-hand inventory, the value that the channel-side calculation provides is much more likely to be accurate for the current store.</span></span>

<span data-ttu-id="5bc22-181">Pour configurer l’opération de PDV **Recherche de stock** dans Commerce Headquarters afin qu’elle utilise la logique de calcul côté canal et pour désactiver l’appel de service en temps réel, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="5bc22-181">To configure the POS **Inventory lookup** operation in headquarters to use the channel-side calculation logic and turn off real-time service call, follow these steps.</span></span>

1. <span data-ttu-id="5bc22-182">Accédez à **Retail et Commerce \> Paramétrage du canal \> Paramétrage POS \> Profils POS \> Profils de fonctionnalité**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-182">Go to **Retail and Commerce \> Channel setup \> POS setup \> POS profiles \> Functionality profiles**.</span></span>
1. <span data-ttu-id="5bc22-183">Sélectionnez un profil de fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="5bc22-183">Select a functionality profile.</span></span>
1. <span data-ttu-id="5bc22-184">Dans le raccourci **Fonctions**, dans la section **Calcul de la disponibilité du stock**, modifiez la valeur du champ **Mode de calcul de la disponibilité du stock** de **Service en temps réel** à **Canal**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-184">On the **Functions** FastTab, in the **Inventory availability calculation** section, change the value of **Inventory availability calculation mode** from **Real time service** to **Channel**.</span></span> <span data-ttu-id="5bc22-185">Par défaut, tous les profils de fonctionnalité utilisent les appels de service en temps réel.</span><span class="sxs-lookup"><span data-stu-id="5bc22-185">By default, all functionality profiles use real-time service calls.</span></span> <span data-ttu-id="5bc22-186">Vous devez modifier la valeur de ce champ si vous souhaitez utiliser la logique de calcul côté canal.</span><span class="sxs-lookup"><span data-stu-id="5bc22-186">You must change the value of this field if you want to use channel-side calculation logic.</span></span> <span data-ttu-id="5bc22-187">Chaque magasin de vente au détail lié au profil de fonctionnalité sélectionné sera affecté par cette modification.</span><span class="sxs-lookup"><span data-stu-id="5bc22-187">Every retail store that is linked to the selected functionality profile will be affected by this change.</span></span>

<span data-ttu-id="5bc22-188">Vous devez ensuite synchroniser les modifications apportées aux canaux via le processus de planification de distribution dans Commerce Headquarters en procédant comme suit.</span><span class="sxs-lookup"><span data-stu-id="5bc22-188">You must then sync the changes to the channels through the distribution schedule process in headquarters by following these steps.</span></span>

1. <span data-ttu-id="5bc22-189">Accédez à **Commerce et vente au détail \> Informatique Commerce et vente au détail \> Programme de distribution**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-189">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="5bc22-190">Exécutez la tâche **1070** (**Configuration du canal**).</span><span class="sxs-lookup"><span data-stu-id="5bc22-190">Run the **1070** (**Channel configuration**) job.</span></span>

<span data-ttu-id="5bc22-191">Une fois la configuration terminée, les informations fournies sur le stock physiquement disponible n’utilisent plus un appel de service en temps réel lorsqu’un utilisateur de l’application PDV utilise l’opération **Recherche de stock** (vues standard et matricielles).</span><span class="sxs-lookup"><span data-stu-id="5bc22-191">After the configuration is completed, the information that is provided about physically available inventory no longer uses a real-time service call when a user in the POS application uses the **Inventory lookup** operation (standard and matrix views).</span></span> <span data-ttu-id="5bc22-192">A la place, les données sur le stock physiquement disponible pour le magasin actuel et tous les magasins du groupe d’exécution sont calculées sur la base du dernier instantané connu qui a été envoyé à la base de données du canal à partir de Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="5bc22-192">Instead, data about physically available inventory for the current store and all the stores in the fulfillment group is calculated based on the last-known snapshot that was delivered to the channel database from Commerce Headquarters.</span></span> <span data-ttu-id="5bc22-193">La valeur de l’instantané est ensuite affinée par le calcul côté canal pour ajuster la valeur physiquement disponible, en fonction des transactions de vente ou de retour supplémentaires disponibles pour le produit sélectionné dans la base de données du canal qui n’étaient pas incluses dans le dernier instantané synchronisé à partir de la tâche 1130.</span><span class="sxs-lookup"><span data-stu-id="5bc22-193">The snapshot value is further refined by the channel-side calculation to adjust the physically available value, based on additional sales or return transactions that exist for the selected product in the channel database that were not included in the last synchronized snapshot from the 1130 job.</span></span> <span data-ttu-id="5bc22-194">Si la base de données du canal ne contient pas de données transactionnelles pour les entrepôts ou les magasins du groupe d’exécution, elle ne contient aucune transaction supplémentaire pouvant être prise en compte dans un recalcul de la valeur.</span><span class="sxs-lookup"><span data-stu-id="5bc22-194">If the channel database doesn't contain transactional data for any of the warehouses or stores in the fulfillment group, it contains no additional transactions that can be factored into a recalculation of the value.</span></span> <span data-ttu-id="5bc22-195">Par conséquent, la meilleure estimation du stock disponible pouvant être affichée pour ces entrepôts ou magasins sont les données du dernier instantané connu de Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="5bc22-195">Therefore, the best estimate of on-hand inventory that can be shown for those warehouses or stores is the data from the last-known Commerce Headquarters snapshot.</span></span>

<span data-ttu-id="5bc22-196">Les écrans **Exécution des commandes** du PDV utilisent également le calcul côté canal pour afficher le stock disponible des articles lorsqu’une ligne de traitement de commande est sélectionnée et qu’un utilisateur affiche le volet **Détails** pour le stock disponible de l’article sélectionné.</span><span class="sxs-lookup"><span data-stu-id="5bc22-196">The **Order fulfillment** screens of POS also leverage the channel side calculation to show on-hand inventory for items when an order fulfillment line is selected and a user views the **Details** panel for on-hand inventory for the selected item.</span></span>

## <a name="optimize-your-inventory-data"></a><span data-ttu-id="5bc22-197">Optimiser vos données de stock</span><span class="sxs-lookup"><span data-stu-id="5bc22-197">Optimize your inventory data</span></span>

<span data-ttu-id="5bc22-198">Pour garantir la meilleure estimation possible du stock, il est important d’utiliser les traitements par lots suivants de Commerce et de les exécuter régulièrement :</span><span class="sxs-lookup"><span data-stu-id="5bc22-198">To ensure the best possible estimate of inventory, it's critical that you use the following Commerce batch jobs and run them frequently:</span></span>

- <span data-ttu-id="5bc22-199">**Tâche P** : elle est disponible sur la page **Programmes de distribution** et doit être exécutée régulièrement.</span><span class="sxs-lookup"><span data-stu-id="5bc22-199">**P-job** – The P-job is found on the **Distribution schedules** page and should be run frequently.</span></span> <span data-ttu-id="5bc22-200">Cette tâche importe les commandes de commerce électronique, les commandes client asynchrones créées par le PDV et les commandes au comptant sans livraison créées par le PDV depuis les bases de données du canal vers Commerce Headquarters, afin qu’elles puissent être traitées plus en détail.</span><span class="sxs-lookup"><span data-stu-id="5bc22-200">This job brings e-Commerce orders, asynchronous customer orders that POS created, and cash-and-carry orders that POS created from the channel databases into Commerce Headquarters, so that they can be processed further.</span></span> <span data-ttu-id="5bc22-201">Tant que ces données ne sont pas synchronisées entre le canal et Commerce Headquarters, Commerce Headquarters ne dispose d’aucune information sur les ajustements du stock des produits dans les entrepôts qui résultent de ces transactions.</span><span class="sxs-lookup"><span data-stu-id="5bc22-201">Until this data is synced from the channel to Commerce Headquarters, Commerce Headquarters has no information about inventory adjustments to products in the warehouses that result from those transactions.</span></span>
- <span data-ttu-id="5bc22-202">**Synchroniser les commandes** : cette tâche traite les données transactionnelles brutes de Commerce Headquarters fournies par la tâche P et convertit les transactions de commande client de commerce électronique et asynchrones en commandes client dans Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="5bc22-202">**Synchronize orders** – This job processes the raw transactional data in Commerce Headquarters that the P-job provides and converts e-Commerce and asynchronous customer order transactions into sales orders in Commerce Headquarters.</span></span> <span data-ttu-id="5bc22-203">Tant que cette tâche n’est pas traitée et que les commandes client ne sont pas créées, aucune transaction de stock n’est créée.</span><span class="sxs-lookup"><span data-stu-id="5bc22-203">Until this job is processed and the sales orders are created, no inventory transactions are created.</span></span> <span data-ttu-id="5bc22-204">Par conséquent, le stock disponible dans Commerce Headquarters ne tient pas compte des transactions.</span><span class="sxs-lookup"><span data-stu-id="5bc22-204">Therefore, on-hand inventory in Commerce Headquarters won't consider the transactions.</span></span>
- <span data-ttu-id="5bc22-205">**Calculer les relevés transactionnels par lots** : pour les transactions au comptant sans livraison créées dans le magasin, le processus de validation en flux continu garantit que le stock lié aux ventes est bien mis à jour.</span><span class="sxs-lookup"><span data-stu-id="5bc22-205">**Calculate transactional statements in batch** – For cash-and-carry transactions that are created in the store, the trickle feed posting process ensures that inventory that is related to the sales is updated efficiently.</span></span> <span data-ttu-id="5bc22-206">Pour obtenir le traitement le plus efficace des transactions de stock pour les commandes au comptant sans livraison, veillez à configurer votre système pour utiliser la [validation en flux continu](./trickle-feed.md).</span><span class="sxs-lookup"><span data-stu-id="5bc22-206">To get the most efficient processing of inventory transactions for cash-and-carry orders, make sure that you configure your system to use [trickle feed posting](./trickle-feed.md).</span></span>
- <span data-ttu-id="5bc22-207">**Valider les relevés transactionnels par lots** : cette tâche est également requise pour la validation en flux continu.</span><span class="sxs-lookup"><span data-stu-id="5bc22-207">**Post transactional statements in batch** – This job is also required for trickle feed posting.</span></span> <span data-ttu-id="5bc22-208">Elle suit la tâche **Calculer les relevés transactionnels par lots**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-208">It follows the **Calculate transactional statements in batch** job.</span></span> <span data-ttu-id="5bc22-209">Cette tâche valide systématiquement les relevés calculés, afin que les commandes client pour les ventes au comptant sans livraison créées dans Commerce Headquarters reflètent plus précisément le stock de votre magasin.</span><span class="sxs-lookup"><span data-stu-id="5bc22-209">This job systematically posts the calculated statements, so that sales orders for cash-and-carry sales are created in Commerce Headquarters and Commerce Headquarters more accurately reflects your store's inventory.</span></span>
- <span data-ttu-id="5bc22-210">**Disponibilité du produit** : cette tâche crée un instantané du stock à partir de Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="5bc22-210">**Product availability** – This job creates the snapshot of inventory from Commerce Headquarters.</span></span>
- <span data-ttu-id="5bc22-211">**1130 (Disponibilité du produit)**  : cette tâche est disponible sur la page **Programmes de distribution** et doit être exécutée immédiatement après la tâche **Disponibilité du produit**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-211">**1130 (Product availability)** – This job is found on the **Distribution schedules** page and should be run immediately after the **Product availability** job.</span></span> <span data-ttu-id="5bc22-212">Cette tâche transfère les données de l’instantané du stock depuis Commerce Headquarters vers les bases de données du canal.</span><span class="sxs-lookup"><span data-stu-id="5bc22-212">This job transports the inventory snapshot data from Commerce Headquarters to the channel databases.</span></span>

> [!NOTE]
> - <span data-ttu-id="5bc22-213">Il est recommandé d’exécuter les tâches **Disponibilité du produit** et **1130** par heure, de planifier la tâche P, de synchroniser les commandes et de diffuser les tâches liées à la publication de flux avec la même fréquence ou plus.</span><span class="sxs-lookup"><span data-stu-id="5bc22-213">It is a best practice to run the **Product availability** and **1130** jobs on an hourly basis, and to schedule P-job, synchronize orders, and trickle feed posting-related jobs with the same or higher frequency.</span></span>
> - <span data-ttu-id="5bc22-214">Pour des raisons de performances, lorsque les calculs de la disponibilité du stock côté canal sont utilisés pour effectuer une demande de disponibilité du stock à l’aide des API de commerce électronique ou de la logique de stock côté canal PDV, le calcul utilise un cache pour déterminer si un délai suffisant s’est écoulé pour justifier la réexécution de la logique de calcul.</span><span class="sxs-lookup"><span data-stu-id="5bc22-214">For performance reasons, when channel-side inventory availability calculations are used to make an inventory availability request using the e-Commerce API's or the POS channel-side inventory logic, the calculation uses a cache to determine whether enough time has passed to justify running the calculation logic again.</span></span> <span data-ttu-id="5bc22-215">Le cache par défaut est défini sur 60 secondes.</span><span class="sxs-lookup"><span data-stu-id="5bc22-215">The default cache is set to 60 seconds.</span></span> <span data-ttu-id="5bc22-216">Par exemple, vous avez activé le calcul côté canal pour votre magasin et affiché le stock disponible pour un produit sur la page **Recherche de stock**.</span><span class="sxs-lookup"><span data-stu-id="5bc22-216">For example, you turned on channel-side calculation for your store and viewed the on-hand inventory for a product on the **Inventory lookup** page.</span></span> <span data-ttu-id="5bc22-217">Si une unité du produit est ensuite vendue, la page **Recherche de stock** n’affiche pas le stock réduit tant que le cache n’a pas été effacé.</span><span class="sxs-lookup"><span data-stu-id="5bc22-217">If one unit of the product is then sold, the **Inventory lookup** page won't show the reduced inventory until the cache has been cleared.</span></span> <span data-ttu-id="5bc22-218">Une fois que les utilisateurs valident des transactions dans le PDV, ils doivent attendre 60 secondes avant de vérifier que le stock disponible a été réduit.</span><span class="sxs-lookup"><span data-stu-id="5bc22-218">After users post transactions in POS, they should wait 60 seconds before they verify that the on-hand inventory has been reduced.</span></span>

<span data-ttu-id="5bc22-219">Si votre scénario d’entreprise nécessite un temps de mise en cache plus petit, contactez le représentant du support technique pour obtenir de l’aide.</span><span class="sxs-lookup"><span data-stu-id="5bc22-219">If your business scenario requires a smaller cache time, contact your product support representative for assistance.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]
