---
title: Créer une configuration de gestion des états électroniques pour générer des états au format Word
description: Cette rubrique explique comment les utilisateurs peuvent configurer un nouveau format de gestion des états électroniques pour générer des rapports comme documents Microsoft Word.
author: NickSelin
ms.date: 12/17/2020
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner,  LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: Version 10.0.6
ms.openlocfilehash: 4885caf017fa0f9d36d293fa32aad53c21d3f162
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/31/2021
ms.locfileid: "5753574"
---
# <a name="design-a-new-er-configuration-to-generate-reports-in-word-format"></a><span data-ttu-id="9d8dc-103">Créer une configuration de gestion des états électroniques pour générer des états au format Word</span><span class="sxs-lookup"><span data-stu-id="9d8dc-103">Design a new ER configuration to generate reports in Word format</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="9d8dc-104">Pour générer des états comme documents Microsoft Word, vous devez concevoir un modèle pour les rapports en utilisant, par exemple, l’application de bureau Word.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-104">To generate reports as Microsoft Word documents, you must design a template for the reports by using, for example, the Word desktop application.</span></span> <span data-ttu-id="9d8dc-105">L’illustration suivante montre l’exemple de modèle de rapport de contrôle qui peut être généré pour afficher les détails des paiements fournisseur traités.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-105">The following illustration shows the sample template for the control report that can be generated to show details of processed vendor payments.</span></span>

![Exemple de modèle pour le rapport de contrôle dans l’application de bureau Word](./media/er-design-configuration-word-image1.png)

<span data-ttu-id="9d8dc-107">Pour utiliser un document Word comme modèle d’états au format Word, vous pouvez configurer une nouvelle [solution](er-quick-start1-new-solution.md) de [gestion des états électroniques](general-electronic-reporting.md).</span><span class="sxs-lookup"><span data-stu-id="9d8dc-107">To use a Word document as a template for reports in Word format, you can configure a new [Electronic reporting (ER)](general-electronic-reporting.md) [solution](er-quick-start1-new-solution.md).</span></span> <span data-ttu-id="9d8dc-108">Cette solution doit inclure une [configuration](general-electronic-reporting.md#Configuration) de gestion des états électroniques qui contient un composant de [format](general-electronic-reporting.md#FormatComponentOutbound) de gestion des états électroniques.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-108">This solution must include an ER [configuration](general-electronic-reporting.md#Configuration) that contains an ER [format](general-electronic-reporting.md#FormatComponentOutbound) component.</span></span>

> [!NOTE]
> <span data-ttu-id="9d8dc-109">Lorsque vous créez une configuration de format de gestion des états électroniques pour générer des états au format Word, vous devez soit sélectionner **Word** comme le type de format dans la boîte de dialogue déroulante **Créer une configuration**, soit laisser le champ **Type de format** vide.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-109">When you create a new ER format configuration to generate reports in Word format, you must either select **Word** as the format type in the **Create configuration** drop-down dialog box or leave the **Format type** field blank.</span></span>

![Créer une configuration du format personnalisé sur la page Configurations](./media/er-design-configuration-word-image2.gif)

<span data-ttu-id="9d8dc-111">Le composant de format de gestion des états électroniques de la solution doit contenir l’élément de format **Excel\\File**, et cet élément de format doit être lié au document Word qui sera utilisé comme modèle pour les états générés lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-111">The ER format component of the solution must contain the **Excel\\File** format element, and that format element must be linked to the Word document that will be used as the template for generated reports at runtime.</span></span> <span data-ttu-id="9d8dc-112">Pour configurer le composant de format de gestion des états électroniques, vous devez ouvrir la version [Brouillon](general-electronic-reporting.md#component-versioning) de la configuration de gestion des états électroniques créée dans le concepteur de format de gestion des états électroniques.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-112">To configure the ER format component, you must open the [draft](general-electronic-reporting.md#component-versioning) version of the created ER configuration in the ER format designer.</span></span> <span data-ttu-id="9d8dc-113">Puis ajoutez l’élément de **Excel\\File**, joignez votre modèle Word au format de gestion des états électroniques modifiable et associez ce modèle à l’élément **Excel\\File** que vous avez ajouté.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-113">Then add the **Excel\\File** element, attach your Word template to the editable ER format, and link that template to the **Excel\\File** element that you added.</span></span>

> [!NOTE]
> <span data-ttu-id="9d8dc-114">Lorsque vous joignez manuellement un modèle, vous devez utiliser un [type de document](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) précédemment [configuré](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) dans les paramètres de gestion des états électroniques pour enregistrer les modèles de formats de gestion des états électroniques.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-114">When you attach a template, you must use a [document type](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) that has previously been [configured](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) in the ER parameters to store templates of ER formats.</span></span>

![Joindre un modèle sur la page Concepteur de format](./media/er-design-configuration-word-image3.gif)

<span data-ttu-id="9d8dc-116">Vous pouvez ajouter des éléments imbriqués **Excel\\Range** et **Excel\\Cell** pour l’élément **Excel\\File** pour préciser la structure des données qui seront saisies dans les états générés au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-116">You can add **Excel\\Range** and **Excel\\Cell** nested elements for the **Excel\\File** element to specify the structure of data that will be entered in generated reports at runtime.</span></span> <span data-ttu-id="9d8dc-117">Vous devez ensuite associer ces éléments aux sources de données du format de gestion des états électroniques modifiable pour spécifier les données réelles qui seront entrées dans les états générés lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-117">You must then bind those elements to data sources of the editable ER format to specify the actual data that will be entered in generated reports at runtime.</span></span>

![Ajouter les éléments imbriqués sur la page Concepteur de format](./media/er-design-configuration-word-image4.gif)

<span data-ttu-id="9d8dc-119">Lorsque vous enregistrez vos modifications au format de gestion des états électroniques au moment de la conception, la structure de format hiérarchique est stockée dans le modèle Word joint en tant que [partie XML personnalisée](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) qui est nommé **État**.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-119">When you save your changes to the ER format at design time, the hierarchical format structure is stored in the attached Word template as a [custom XML part](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) that is named **Report**.</span></span> <span data-ttu-id="9d8dc-120">Vous devez accéder au modèle modifié, le télécharger depuis Finance, le stocker localement et l’ouvrir dans l’application de bureau Word.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-120">You must access the modified template, download it from Finance, store it locally, and open it in the Word desktop application.</span></span> <span data-ttu-id="9d8dc-121">L’illustration suivante montre l’exemple de modèle stocké localement pour le rapport de contrôle qui contient la partie XML personnalisée **État**.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-121">The following illustration shows the locally stored sample template for the control report that contains the **Report** custom XML part.</span></span>

![Afficher l’aperçu du modèle pour le rapport de contrôle dans l’application de bureau Word](./media/er-design-configuration-word-image5.gif)

<span data-ttu-id="9d8dc-123">Lors de la liaison des éléments de format **Excel\\Range** et **Excel\\Cell** au moment de l’exécution, les données fournies par chaque liaison sont intégrées au document Word en tant que champ individuel de la partie XML personnalisée **État**.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-123">When bindings of **Excel\\Range** and **Excel\\Cell** format elements are run at runtime, the data that every binding delivers comes into the generated Word document as an individual field of the **Report** custom XML part.</span></span> <span data-ttu-id="9d8dc-124">Pour entrer les valeurs des champs de la partie XML personnalisée dans un document généré, vous devez ajouter le mot approprié [contrôles de contenu](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) à votre modèle Word pour servir d’espace réservé pour les données qui seront renseignées lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-124">To enter the values from the fields of the custom XML part in a generated document, you must add the appropriate Word [content controls](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) to your Word template to serve as placeholders for data that will be filled in at runtime.</span></span> <span data-ttu-id="9d8dc-125">Pour spécifier la manière dont les contrôles de contenu sont remplis, mappez chaque contrôle de contenu au champ approprié de la partie XML personnalisée **État**.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-125">To specify how content controls are filled in, map every content control to the appropriate field of the **Report** custom XML part.</span></span>

![Ajout et mappage de contrôles de contenu dans l’application de bureau Word](./media/er-design-configuration-word-image6.gif)

<span data-ttu-id="9d8dc-127">Vous devez ensuite remplacer le modèle Word d’origine du format pour la gestion des états électroniques modifiable par le modèle modifié qui contient désormais les contrôles de contenu Word mappés aux champs de la partie XML personnalisée **État**.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-127">You must then replace the original Word template of the editable ER format with the modified template that now contains Word content controls that were mapped to the fields of the **Report** custom XML part.</span></span>

![Remplacer le modèle sur la page du concepteur de format](./media/er-design-configuration-word-image7.gif)

<span data-ttu-id="9d8dc-129">Lorsque vous exécutez le format pour la gestion des états électroniques configuré, le modèle Word joint est utilisé pour générer un nouveau rapport.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-129">When you run the configured ER format, the attached Word template is used to generate a new report.</span></span> <span data-ttu-id="9d8dc-130">Les données réelles sont stockées dans le rapport Word en tant que partie XML personnalisée nommée **État**.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-130">The actual data is stored in the Word report as a custom XML part that is named **Report**.</span></span> <span data-ttu-id="9d8dc-131">Lorsque le rapport généré est ouvert, les contrôles de contenu Word sont remplis avec les données de la partie XML personnalisée **État**.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-131">When the generated report is opened, the Word content controls are filled in with data from the **Report** custom XML part.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="9d8dc-132">Forum aux questions</span><span class="sxs-lookup"><span data-stu-id="9d8dc-132">Frequently asked questions</span></span>

<span data-ttu-id="9d8dc-133">**Question :** J’ai configuré un format pour la gestion des états électroniques pour imprimer un document Word contenant une adresse d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-133">**Question:** I configured an ER format to print a Word document that contains a company address.</span></span> <span data-ttu-id="9d8dc-134">Dans le modèle Word pour ce format pour la gestion des états électroniques, j’ai inséré un contrôle de contenu en texte enrichi pour présenter une adresse d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-134">In the Word template for this ER format, I inserted a rich text content control to present a company address.</span></span> <span data-ttu-id="9d8dc-135">Dans Finance, j’ai entré l’adresse de l’entreprise sous forme de texte multiligne et j’ai sélectionné **Entrée** pour ajouter un retour chariot pour chaque ligne que j’ai entrée.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-135">In Finance, I entered the company address as multiline text and selected **Enter** to add a carriage return for every line that I entered.</span></span> <span data-ttu-id="9d8dc-136">Par conséquent, je m’attends à ce que l’adresse de l’entreprise apparaisse sous forme de texte multiligne dans les documents générés.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-136">Therefore, I expect the company address to appear as multiline text in generated documents.</span></span> <span data-ttu-id="9d8dc-137">Cependant, l’adresse apparaît sous la forme d’une seule ligne de texte contenant des symboles spéciaux au lieu de retours chariot.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-137">However, the address appears as a single line of text that contains special symbols instead of carriage returns.</span></span> <span data-ttu-id="9d8dc-138">Quel est le problème avec mes paramètres ?</span><span class="sxs-lookup"><span data-stu-id="9d8dc-138">What is wrong with my settings?</span></span>

<span data-ttu-id="9d8dc-139">**Réponse :** au lieu d’utiliser un contrôle de contenu de texte enrichi, vous devez utiliser un contrôle de contenu de texte brut et cocher la case **Autoriser les retours chariot (plusieurs paragraphes)** dans les propriétés du contrôle.</span><span class="sxs-lookup"><span data-stu-id="9d8dc-139">**Answer:** Instead of using a rich text content control, you must use a plain text content control and select the **Allow carriage returns (multiple paragraphs)** check box in the control's properties.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="9d8dc-140">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="9d8dc-140">Additional resources</span></span>

- [<span data-ttu-id="9d8dc-141">Réutiliser les configurations pour la gestion des états électroniques avec des modèles Excel pour générer des rapports au format Word</span><span class="sxs-lookup"><span data-stu-id="9d8dc-141">Reuse ER configurations with Excel templates to generate reports in Word format</span></span>](./tasks/er-design-configuration-word-2016-11.md)
- [<span data-ttu-id="9d8dc-142">Intégrer des images et des formes dans les documents que vous générez ER à l’aide de la gestion des états électroniques (ER)</span><span class="sxs-lookup"><span data-stu-id="9d8dc-142">Embed images and shapes in documents that you generate by using ER</span></span>](electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]