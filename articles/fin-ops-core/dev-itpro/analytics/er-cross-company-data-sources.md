---
title: Sources de données de société croisée dans la gestion des états électroniques (ER)
description: Cette rubrique explique comment utiliser les sources de données de société croisée dans la gestion des états électroniques.
author: NickSelin
manager: AnnBe
ms.date: 05/25/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ERModelMappingDesigner, ERFormatMappingLegalEntityFilterTable
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: f2e6b4f20464993f736b013dde40527aba2258ed
ms.sourcegitcommit: 564aa8eec89defdbe2abaf38d0ebc4cca3e28109
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/28/2019
ms.locfileid: "2667642"
---
# <a name="cross-company-data-sources-in-electronic-reporting-er"></a><span data-ttu-id="9af61-103">Sources de données de société croisée dans la gestion des états électroniques (ER)</span><span class="sxs-lookup"><span data-stu-id="9af61-103">Cross-company data sources in Electronic reporting (ER)</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="9af61-104">Vous pouvez créer des formats de gestion des états électroniques pour générer des documents sortants dans différents formats.</span><span class="sxs-lookup"><span data-stu-id="9af61-104">You can design Electronic reporting (ER) formats to generate outgoing documents in various formats.</span></span> <span data-ttu-id="9af61-105">Lorsqu'un document est généré, un format ER appelle les sources de données configurées dans une mise en correspondance des modèles ER correspondante.</span><span class="sxs-lookup"><span data-stu-id="9af61-105">When a document is generated, an ER format calls data sources that were configured in a corresponding ER model mapping.</span></span> <span data-ttu-id="9af61-106">Pour configurer l'accès aux tables d'application pour la récupération des enregistrements, vous pouvez utiliser les sources de données ER du type **Enregistrements de la table**.</span><span class="sxs-lookup"><span data-stu-id="9af61-106">To configure access to application tables for record retrieval, you can use ER data sources of the **Table records** type.</span></span> <span data-ttu-id="9af61-107">Lorsque la table d'accès est une table partagée (c'est-à-dire, une table dans laquelle les données sont enregistrées sans identificateur de société), cette source de données renvoie tous les enregistrements.</span><span class="sxs-lookup"><span data-stu-id="9af61-107">When the accessing table is a shared table (that is, a table where data is saved without a company identifier), this data source returns all records.</span></span> <span data-ttu-id="9af61-108">Lorsque la table d'accès est une table dépendante de la société (c'est-à-dire, une table dans laquelle les données sont enregistrées par société), cette source de données renvoie uniquement les enregistrements enregistrés pour la société actuelle (c'est-à-dire, le contexte de société dans lequel le format ER s'exécute).</span><span class="sxs-lookup"><span data-stu-id="9af61-108">When the accessing table is a company-dependent table (that is, a table where data is saved per company), this data source returns only the records that have been saved for the current company (that is, the company context that the ER format is running under).</span></span>

<span data-ttu-id="9af61-109">Chaque source de données du type **Enregistrements de la table** dans une mise en correspondance des modèles peut maintenant être marquée comme source de données de société croisée.</span><span class="sxs-lookup"><span data-stu-id="9af61-109">Every data source of the **Table records** type in a model mapping can be now marked as a cross-company data source.</span></span> <span data-ttu-id="9af61-110">Par conséquent, vous pouvez utiliser les sources de données du type **Enregistrements de la table** pour accéder aux données de société croisée des tables d'application.</span><span class="sxs-lookup"><span data-stu-id="9af61-110">Therefore, you can use data sources of the **Table records** type to access cross-company data in application tables.</span></span>

<span data-ttu-id="9af61-111">Si vous marquez une source de données comme société croisée, le comportement suivant se produit :</span><span class="sxs-lookup"><span data-stu-id="9af61-111">If you mark a data source as cross-company, the following behavior occurs:</span></span>

- <span data-ttu-id="9af61-112">Pour une source de données qui fait référence à une table partagée, à l'exception de CompanyInfo, la source de données renvoie tous les enregistrements qui existent dans la table référencée.</span><span class="sxs-lookup"><span data-stu-id="9af61-112">For a data source that refers to any shared table except CompanyInfo, the data source returns all records that exist in the referenced table.</span></span> 
- <span data-ttu-id="9af61-113">Pour une source de données qui fait référence à la table CompanyInfo, même si CompanyInfo est une table partagée, la source de données renvoie les enregistrements contenant l'identificateur d'une société à partir de la portée définie.</span><span class="sxs-lookup"><span data-stu-id="9af61-113">For a data source that refers to the CompanyInfo table, even though CompanyInfo is a shared table, the data source returns the records that contain the identifier of a company from the defined scope.</span></span>
- <span data-ttu-id="9af61-114">Pour une table dépendante de la société, la source de données renvoie les enregistrements de la table référencée contenant l'identificateur d'une société à partir de la portée définie.</span><span class="sxs-lookup"><span data-stu-id="9af61-114">For any company-dependent table, the data source returns the records of the referenced table that contain the identifier of a company from the defined scope.</span></span>

<span data-ttu-id="9af61-115">Dans la boîte de dialogue de requête du système, lorsque l'option **Demander une requête** est activée pour une source de données marquée comme société croisée, vous pouvez sélectionner manuellement une ou plusieurs sociétés à inclure dans l'onglet **Plage de la société**.</span><span class="sxs-lookup"><span data-stu-id="9af61-115">In the system query dialog box, when the **Ask for query** option is turned on for any data source that is marked as cross-company, you can manually select one or more companies to include on the **Company range** tab.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9af61-116">Comme les autres filtres, le filtre de société est conservé en tant que dernière valeur utilisée pour les requêtes lorsque vous exécutez un format ER.</span><span class="sxs-lookup"><span data-stu-id="9af61-116">Like other filters, the company filter is persisted as a last-used value for queries when you run an ER format.</span></span> <span data-ttu-id="9af61-117">Le filtre n'est pas automatiquement modifié si vous modifiez la valeur de société croisée pour une source de données.</span><span class="sxs-lookup"><span data-stu-id="9af61-117">The filter isn't automatically changed if you change the cross-company value for a data source.</span></span> <span data-ttu-id="9af61-118">Pour utiliser une valeur de société croisée différente pour une autre source de données, supprimez la sélection spécifique à l'utilisateur correspondante.</span><span class="sxs-lookup"><span data-stu-id="9af61-118">To use a different cross-company value for another data source, delete the corresponding user-specific selection.</span></span>

<span data-ttu-id="9af61-119">Pour chaque source de données marquée comme société croisée, vous pouvez sélectionner les enregistrements souhaités à l'aide des fonctions **FILTER** et **WHERE** des expressions ER.</span><span class="sxs-lookup"><span data-stu-id="9af61-119">For every data source that is marked as cross-company, you can select the records that you want by using the **FILTER** and **WHERE** functions in ER expressions.</span></span> <span data-ttu-id="9af61-120">Le champ **dataAreaID** peut également être utilisé comme identificateur de société.</span><span class="sxs-lookup"><span data-stu-id="9af61-120">The **dataAreaID** field can also be used as a company identifier.</span></span> <span data-ttu-id="9af61-121">Pour le moment, le champ **dataAreaID** est limité aux types suivants de conditions lorsque la fonction **FILTER** est utilisée :</span><span class="sxs-lookup"><span data-stu-id="9af61-121">Currently, the **dataAreaID** field is limited to the following types of conditions when the **FILTER** function is used:</span></span>

- <span data-ttu-id="9af61-122">Seules les conditions qui ont une comparaison de champ **dataAreaID** unique sont prises en charge.</span><span class="sxs-lookup"><span data-stu-id="9af61-122">Only conditions that have a single **dataAreaID** field comparison are supported.</span></span>
- <span data-ttu-id="9af61-123">Seules les comparaisons qui ont des expressions qui ne dépendent pas des éléments de liste d'enregistrements sont autorisées.</span><span class="sxs-lookup"><span data-stu-id="9af61-123">Only comparisons that have expressions that don't depend on records list items are allowed.</span></span>

<span data-ttu-id="9af61-124">Par conséquent, l'expression suivante est valide.</span><span class="sxs-lookup"><span data-stu-id="9af61-124">Therefore, the following expression is valid.</span></span>

```
FILTER (MyTable, MyTable.dataAreaID = $StringUserInputParameter)
While shown below expressions will not pass the validation:
FILTER (MyTable, MyTable.dataAreaID = MyTable2RecordsList.MyField)
FILTER (MyTable, 
    OR(
        MyTable.dataAreaID = $StringUserInputParameter1,
        MyTable.dataAreaID = $StringUserInputParameter2
    )
)
```

<span data-ttu-id="9af61-125">Par défaut, la portée comprend toutes les sociétés de l'application actuelle.</span><span class="sxs-lookup"><span data-stu-id="9af61-125">By default, the scope includes all companies of the current application.</span></span> <span data-ttu-id="9af61-126">Toutefois, elle peut être limitée.</span><span class="sxs-lookup"><span data-stu-id="9af61-126">However, it can be restricted.</span></span> <span data-ttu-id="9af61-127">Pour limiter la portée de l'accès aux données de société croisée pour un format ER unique, affectez une hiérarchie d'organisation spécifique au format.</span><span class="sxs-lookup"><span data-stu-id="9af61-127">To restrict the scope of cross-company data access for a single ER format, assign a specific organization hierarchy to the format.</span></span> <span data-ttu-id="9af61-128">Lorsqu'une hiérarchie est définie pour un format ER, seuls les enregistrements des entités juridiques présentées dans la hiérarchie affectée sont renvoyés, même si le format appelle les sources de données de société croisée.</span><span class="sxs-lookup"><span data-stu-id="9af61-128">When a hierarchy is defined for an ER format, only records for legal entities that are presented in the assigned hierarchy are returned, even though the format calls cross-company data sources.</span></span> <span data-ttu-id="9af61-129">Lorsqu'une référence à une hiérarchie qui n'existe plus est définie pour un format ER, la portée par défaut est appliquée et le format appelle les sources de données de société croisée.</span><span class="sxs-lookup"><span data-stu-id="9af61-129">When a reference to a hierarchy that no longer exists is defined for an ER format, the default scope is applied, and the format calls cross-company data sources.</span></span> <span data-ttu-id="9af61-130">Dans ce cas, les enregistrements de toutes les sociétés d'application sont renvoyés.</span><span class="sxs-lookup"><span data-stu-id="9af61-130">In this situation, records for all application companies are returned.</span></span>

<span data-ttu-id="9af61-131">Notez que lorsque l'option **Utiliser un brouillon** est activée pour la hiérarchie d'organisation affectée à un format ER unique, les entités juridiques de la version provisoire de cette hiérarchie sont utilisées pour identifier la portée des sources de données de société croisée.</span><span class="sxs-lookup"><span data-stu-id="9af61-131">Note that when the **Use draft** option is turned on for the assigned to a single ER format organization hierarchy, the legal entities from the draft version of this hierarchy will be used to identify the scope for cross-company data sources.</span></span> <span data-ttu-id="9af61-132">Si la version provisoire n'existe pas, les entités juridiques de la dernière version publiée de cette hiérarchie d'organisation sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="9af61-132">If the draft version does not exist, the legal entities from the last published version of this organization hierarchy will be used for this.</span></span>

<span data-ttu-id="9af61-133">Notez que lorsque l'option **Utiliser un brouillon** est désactivée pour la hiérarchie d'organisation affectée à un format ER unique, les entités juridiques de la dernière version publiée de cette hiérarchie d'organisation sont utilisées pour identifier la portée des sources de données de société croisée.</span><span class="sxs-lookup"><span data-stu-id="9af61-133">Note that when the **Use draft** option is turned off for the assigned to a single ER format organization hierarchy, the legal entities from the last published version of this organization hierarchy will be used to identify the scope for cross-company data sources.</span></span> <span data-ttu-id="9af61-134">La date d'entrée en vigueur des hiérarchies d'organisation n'est pas encore prise en charge dans la structure ER.</span><span class="sxs-lookup"><span data-stu-id="9af61-134">Date effectiveness of organization hierarchies is not supported yet in the ER framework.</span></span>

<span data-ttu-id="9af61-135">La hiérarchie peut être affectée à un format dans une page spécifique accessible à partir de l'espace de travail de gestion des états électroniques ou à l'aide de l'élément de menu **Administration d'organisation \> Gestion des états électroniques \> Filtre d'entité juridique** pour les formats.</span><span class="sxs-lookup"><span data-stu-id="9af61-135">The hierarchy can be assigned to a format in a specific page that can be accessed from the ER workspace or by using the **Organization administration \> Electronic reporting \> Legal entity filter for formats** menu item.</span></span> <span data-ttu-id="9af61-136">Pour accéder à la page, le privilège **Tenir à jour les filtres d'entité juridique pour les formats** (ERMaintainFormatMappingLegalEntityFilters) doit être accordé à un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9af61-136">To access the page, the **Maintain legal entity filters for format** privilege (ERMaintainFormatMappingLegalEntityFilters) must be granted to a user.</span></span> <span data-ttu-id="9af61-137">La restriction de la portée des entités juridiques basées sur la hiérarchie pour le format est appliquée en plus de la restriction que l'utilisateur peut spécifier manuellement dans la boîte de dialogue de requête du système.</span><span class="sxs-lookup"><span data-stu-id="9af61-137">The scope restriction of hierarchy-based legal entities for the format is applied in addition to the restriction that the user can manually specify in the system query dialog box.</span></span> <span data-ttu-id="9af61-138">L'intersection de ces restrictions est utilisée lorsque le format est exécuté.</span><span class="sxs-lookup"><span data-stu-id="9af61-138">The intersection of these restrictions is used when the format is run.</span></span>

<span data-ttu-id="9af61-139">Pour plus d'informations sur cette fonction, lisez le guide de tâches, **ER Accéder aux enregistrements des tables dépendantes de la société en mode de société croisée**, qui fait partie du processus d'entreprise 7.5.4.3 Acquérir/Développer des composants de services/solutions informatiques (10677) et qui peut être téléchargé à partir du [Centre de téléchargement Microsoft](https://go.microsoft.com/fwlink/?linkid=874684).</span><span class="sxs-lookup"><span data-stu-id="9af61-139">To learn more about this feature, play the task guide, **ER Access records of company dependent tables in cross-company mode**, which is part of the 7.5.4.3 Acquire/Develop IT service/solution components (10677) business process, and can be downloaded from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=874684).</span></span> <span data-ttu-id="9af61-140">Ce guide de tâches vous guide tout au long du processus de configuration du modèle ER et du format ER pour accéder aux tables d'application en mode de société croisée.</span><span class="sxs-lookup"><span data-stu-id="9af61-140">This task guide walks you through the process of configuring an ER model mapping and ER format to access application tables in cross-company mode.</span></span>

<span data-ttu-id="9af61-141">Téléchargez les fichiers suivants pour exécuter le guide de tâches :</span><span class="sxs-lookup"><span data-stu-id="9af61-141">Download the following files to complete the task guide:</span></span>

- [<span data-ttu-id="9af61-142">Configuration du modèle ER - CrossCompanyDataAccessModel.xml</span><span class="sxs-lookup"><span data-stu-id="9af61-142">ER model configuration - CrossCompanyDataAccessModel.xml</span></span>](https://go.microsoft.com/fwlink/?linkid=874111)
- [<span data-ttu-id="9af61-143">Configuration du format ER - CrossCompanyDataAccessFormat.xml</span><span class="sxs-lookup"><span data-stu-id="9af61-143">ER format configuration - CrossCompanyDataAccessFormat.xml</span></span>](https://go.microsoft.com/fwlink/?linkid=874111)
